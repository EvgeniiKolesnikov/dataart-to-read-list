{"version":3,"sources":["src/js/api.js","src/js/book-info.js","src/js/buttons-controller.js","src/js/book-card.js","src/js/books-list.js","src/js/data.js","src/js/menu-controller.js","src/js/scroll-controller.js","src/js/search-controller.js","src/js/read-list.js","src/js/storage.js","src/js/toggle-theme.js","src/js/index.js"],"names":["Api","searchBooks","fullQuerry","url","response","fetch","mode","ok","json","console","error","status","searchBooksQuerry","querry","page","searchBookImage","bookLinks","blob","BookInfo","constructor","bookInfoHeader","document","getElementById","bookInfoProps","addToReadList","storage","message","bookAdded","targetBook","read","myBooks","get","checkBookInStorage","filter","item","id","length","push","pushMessage","set","AddToReadMessage","createElement","classList","add","textContent","style","backgroundColor","addToReadButton","appendChild","setTimeout","remove","setBookInfo","book","innerHTML","display","title","subtitle","imageLinks","getImageLinks","loadBookImage","i","addPropsHtml","author_name","join","language","map","getFlagHTML","has_fulltext","first_publish_year","publish_year","propTitle","bookKey","cover_i","isbn","forEach","value","lccn","olid","oclc","api","then","objectURL","window","URL","createObjectURL","bookPicture","src","catch","ButtonsController","bookInfo","readList","addEventListener","e","trackElement","target","tagName","bookId","parentNode","dataset","onChangeReadList","showBook","divId","object","splice","targetDiv","selectBook","find","LastSelectedBook","getElementsByClassName","BookCard","currentPage","booksList","querySelector","onClickBookCard","setCurrentPage","BooksList","addBooksList","docs","key","split","pop","blueBook","redBook","booksListHTML","reduce","acc","skin","booksShown","numShown","booksFound","numFound","start","pageSize","numberShownBooks","Data","bookList","bookCard","getData","pageLoaded","loadedPage","spinnerBig","spinnerMini","concat","getCountPages","countPages","Math","ceil","addData","MenuController","data","onSearchListBtn","onInfoListBtn","onReadListBtn","leftBlock","centerBlock","rightBlock","log","zIndex","ScrollController","scrollBooksList","isScrolledIntoView","scroll","docViewTop","scrollTop","docViewBottom","offsetHeight","scrollHeigh","scrollHeight","canAddData","SearchController","debounce","callback","delay","timeoutId","args","clearTimeout","searchInput","debouncedGreet","onChangeInput","searchButton","searchClear","onClickClear","path","undefined","code","onClearBooksList","focus","currentTarget","ReadList","readListBookCount","readListReadCount","readListBook","readListRead","loadReadList","setReadListHTML","setListAboutHTML","show","bool","sort","prev","next","BookCount","ReadCount","Storage","refresh","name","JSON","parse","localStorage","getItem","setItem","stringify","clear","ToggleTheme","toggleThemeButton","toggleTheme","loadTheme","myTheme","theme","sunIcon","moonIcon","documentElement","setAttribute","hasAttribute","removeAttribute"],"mappings":"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KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,QAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,QAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IA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","file":"js.00af9952.js","sourceRoot":"..","sourcesContent":["'use strict';\r\nexport class Api {\r\n  #apiUrlSearch = `https://openlibrary.org`;\r\n  #apiUrlImage = `https://covers.openlibrary.org`;\r\n  #imageSize = `L`;\r\n\r\n  async searchBooks(fullQuerry) {\r\n    const url = `${this.#apiUrlSearch}/search.json?${fullQuerry}`;\r\n    try {\r\n      const response = await fetch(url, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.json();\r\n      }\r\n      console.error(`Request ${url} failed with ${response.status}`)\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error)\r\n    }\r\n  }\r\n\r\n  async searchBooksQuerry(querry, page) {\r\n    const url = `${this.#apiUrlSearch}/search.json?q=${querry}&page=${page}`;\r\n    try {\r\n      const response = await fetch(url, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.json();\r\n      }\r\n      console.error(`Request ${url} failed with ${response.status}`)\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error)\r\n    }\r\n  }\r\n\r\n  async searchBookImage(bookLinks) {\r\n    const url = `${this.#apiUrlImage}/b/${bookLinks}-${this.#imageSize}.jpg?default=false`;\r\n    try {\r\n      let response = await fetch(`${url}`, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.blob();\r\n      } else {\r\n      // console.error(`Request ${url} failed with ${response.status}`)\r\n      }\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error);\r\n    }\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport { Api } from \"./api\";\r\n\r\n\r\nexport class BookInfo {\r\n  targetBook = [];\r\n  api = new Api();\r\n  i = 0;\r\n  imageLinks = [];\r\n  constructor() {\r\n    // console.log('BookInfo');\r\n    this.bookInfoHeader = document.getElementById(\"bookInfoHeader\");\r\n    this.bookInfoProps = document.getElementById(\"bookInfoProps\");\r\n  }\r\n\r\n  addToReadList(storage) {\r\n    if(!storage) {\r\n      return;\r\n    }\r\n    let message = '';\r\n    let bookAdded = false;\r\n    this.targetBook.read = false;\r\n\r\n    let myBooks = storage.get(\"myBooks\");\r\n    // console.log(myBooks);\r\n    if (myBooks) {\r\n      let checkBookInStorage = myBooks\r\n      .filter(item => item.id == this.targetBook.id).length > 0;\r\n      \r\n      // console.log(`book \"${this.targetBook.title}\" in storage? = ` + checkBookInStorage);\r\n      if (checkBookInStorage) {\r\n        bookAdded = false;\r\n        message = \"This book is already in Read List\";\r\n      } else  {\r\n        myBooks.push(this.targetBook);\r\n        bookAdded = true;\r\n        message = \"This book was added in Read List\";\r\n      } \r\n    } else if (!myBooks) {\r\n      myBooks = [];\r\n      myBooks.push(this.targetBook);\r\n      bookAdded = true;\r\n      message = \"This book was added in Read List\";\r\n    }\r\n\r\n    this.pushMessage(bookAdded, message);\r\n    storage.set(\"myBooks\", myBooks);\r\n  }\r\n\r\n  pushMessage(bookAdded, message) {\r\n    const AddToReadMessage = document.createElement('div');\r\n    AddToReadMessage.classList.add('message');\r\n    AddToReadMessage.textContent = message;\r\n    AddToReadMessage.style.backgroundColor = bookAdded ? '#c6fdcd' : '#fdc6c6';\r\n    addToReadButton.appendChild(AddToReadMessage);  \r\n    setTimeout(function(){AddToReadMessage.remove()}, 2000);\r\n  }\r\n\r\n  setBookInfo(book) {\r\n    this.targetBook = book;\r\n    this.bookInfoHeader.innerHTML = ``;\r\n    this.bookInfoProps.innerHTML = ``;\r\n    addToReadButton.style.display = \"block\";\r\n    // this.bookInfoProps.innerHTML += book.title ? `<h2 class=\"book-info__title\">${book.title}</h2>` : ``; // var 3\r\n    // book.title && (this.bookInfoProps.innerHTML += `<h3 class=\"book-info__title\">${book.title}</h3>`);   // var 2\r\n    this.bookInfoHeader.innerHTML += `<h2 class=\"book-info__title\">${book.title}</h2>`;                     // var 1\r\n    if (book.subtitle) {\r\n      this.bookInfoProps.innerHTML += `<h3 class=\"book-info__subtitle\">${book.subtitle}</h3>` \r\n    }\r\n    this.bookInfoProps.innerHTML += `<img class=\"book-info__img\" id=\"bookPicture\"></img>`; \r\n    this.imageLinks = this.getImageLinks(book);\r\n    this.loadBookImage(this.imageLinks, this.i);\r\n    this.addPropsHtml(`Author:`, book.author_name?.join(\", \"));\r\n    this.addPropsHtml(`Languages available:`, book.language\r\n      ?.map(item => this.getFlagHTML(item) + item)\r\n      .join(\", \"));\r\n    this.addPropsHtml(`Full text available:`, book.has_fulltext);\r\n    this.addPropsHtml(`First publish year:`, book.first_publish_year);\r\n    this.addPropsHtml(`Years published:`, book.publish_year?.join(\", \"));\r\n  }\r\n\r\n  addPropsHtml(propTitle, bookKey) {\r\n    if (bookKey) {\r\n      this.bookInfoProps.innerHTML +=  \r\n      `<div class=\"book-info__prop\">\r\n        <span class=\"book-info__prop-title\">${propTitle}</span>\r\n        <span class=\"book-info__prop-value\">${bookKey}</span>\r\n      </div>`\r\n    }\r\n  }\r\n\r\n  getImageLinks(book) {\r\n    this.i = 0;               // индекс первого искомого элемента в массиве картинкок\r\n    const imageLinks = [];    // Все возможные части ссылок на картинки\r\n\r\n    book.cover_i && imageLinks.push(`id/${book.cover_i}`);\r\n    book.isbn && book.isbn.forEach(value => imageLinks.push(`isbn/${value}`));\r\n    book.lccn && book.lccn.forEach(value => imageLinks.push(`lccn/${value}`));\r\n    book.olid && book.olid.forEach(value => imageLinks.push(`olid/${value}`));\r\n    book.oclc && book.oclc.forEach(value => imageLinks.push(`oclc/${value}`));\r\n    return imageLinks;\r\n  }\r\n\r\n  loadBookImage(imageLinks, i) {\r\n    if (!imageLinks[i] || imageLinks.length == this.i) return;\r\n    // console.log('link = ', imageLinks[i], '; i = ', i);\r\n    this.api.searchBookImage(imageLinks[i]).then(blob => {\r\n      let objectURL = window.URL.createObjectURL(blob);\r\n      let bookPicture = document.getElementById('bookPicture');\r\n      if (bookPicture.src === '') {\r\n        bookPicture.src = objectURL;\r\n      }\r\n    })\r\n    .catch (error => {\r\n      // console.log('error:', error);\r\n      // Если нету картинки по ссылке, смотрим следующую \r\n      // и так, пока не найдётся или не закончатся варианты\r\n      this.i++;\r\n      this.loadBookImage(this.imageLinks, this.i);\r\n    });\r\n  }\r\n//#region getFlagsHTML\r\n  getFlagHTML(item) {\r\n    // console.log(item);\r\n    if (item == 'eng') item = 'gb';\r\n    if (item == 'rus') item = 'ru';\r\n    if (item == 'spa') item = 'es';\r\n    if (item == 'esp') item = 'es';\r\n    if (item == 'ger') item = 'de';\r\n    if (item == 'chi') item = 'cn';\r\n    if (item == 'ukr') item = 'ua';\r\n    if (item == 'fre') item = 'fr';\r\n    if (item == 'ita') item = 'it';\r\n    if (item == 'jpn') item = 'jp';\r\n    if (item == 'por') item = 'pt';\r\n    if (item == 'iri') item = 'ie';\r\n    if (item == 'alb') item = 'al';\r\n    if (item == 'scc') item = 'rs';\r\n    if (item == 'dut') item = 'nl';\r\n    if (item == 'dan') item = 'dk';\r\n    if (item == 'cze') item = 'cz';\r\n    if (item == 'mon') item = 'mn';\r\n    if (item == 'scr') item = 'hr';\r\n    if (item == 'hrv') item = 'hr';\r\n    if (item == 'ara') item = 'ae';\r\n    if (item == 'pol') item = 'pl';\r\n    if (item == 'fin') item = 'fi';\r\n    if (item == 'swe') item = 'se';\r\n    if (item == 'rum') item = 'ro';\r\n    if (item == 'est') item = 'ee';\r\n    if (item == 'sco') item = 'gb-sct';\r\n    if (item == 'grc') item = 'gr';\r\n    if (item == 'hun') item = 'hu';\r\n    if (item == 'slo') item = 'sk';\r\n    if (item == 'kor') item = 'kr';\r\n    if (item == 'ice') item = 'is';\r\n    if (item == 'bul') item = 'bg';\r\n    if (item == 'tur') item = 'tr';\r\n    if (item == 'gre') item = 'gr';\r\n    if (item == 'arm') item = 'am';\r\n    if (item == 'wal') item = 'gb-wls';\r\n    if (item == 'amh') item = 'et';\r\n    if (item == 'mol') item = 'md';\r\n    if (item == 'tgl') item = 'ph';\r\n    if (item == 'heb') item = 'il';\r\n    if (item == 'lit') item = 'lt';\r\n    if (item == 'vie') item = 'vn';\r\n    if (item == 'nor') item = 'no';\r\n    if (item.length === 3) return ``;\r\n    return `<img class=\"book-info__flag\" src=\"https://flagcdn.com/16x12/${item}.png\"></img> `;\r\n  }\r\n  //#endregion getFlagsHTML\r\n}","'use strict';\r\n\r\nexport class ButtonsController {\r\n  bookId;\r\n  constructor(storage, bookInfo) {\r\n    // console.log('ButtonsController');\r\n    this.storage = storage;\r\n    this.bookInfo = bookInfo;\r\n    this.readList = document.getElementById(\"readList\");\r\n    const addToReadButton = document.getElementById(\"addToReadButton\");\r\n\r\n    addToReadButton.addEventListener(\"click\", e => \r\n    this.bookInfo.addToReadList(this.storage));\r\n\r\n    this.readList.addEventListener(\"click\", e => this.trackElement(e));\r\n  }\r\n\r\n  trackElement(e) {\r\n    let item = e.target;\r\n    if (item.tagName == 'BUTTON') {\r\n      // console.log('click button');\r\n      this.bookId = item.parentNode.parentNode.parentNode.parentNode.dataset.bookId;\r\n      this.onChangeReadList(this.bookId, item.id);\r\n    }  \r\n    if (item.tagName == 'DIV') {\r\n      // console.log('click book');\r\n      this.bookId = item.dataset.bookId;\r\n      this.showBook(this.bookId, e);\r\n    }\r\n  }\r\n\r\n  onChangeReadList(bookId, divId) {\r\n    const myBooks = this.storage.get(\"myBooks\");\r\n    myBooks.forEach((item, i, object) => {\r\n      if (item.id == bookId) {\r\n        if (divId == 'markAsReadButton') {\r\n          item.read = true;\r\n        }\r\n        if (divId == 'unmarkAsReadButton') {\r\n          item.read = false;\r\n        }\r\n        if (divId == 'removefromListButton') {\r\n          object.splice(i, 1);\r\n        }\r\n      }\r\n    });\r\n    this.storage.set(\"myBooks\", myBooks);\r\n  }\r\n\r\n  showBook(bookId, e) {\r\n    const targetDiv = e.target;\r\n    const myBooks = this.storage.get(\"myBooks\");\r\n    const selectBook = myBooks.find(item => item.id == bookId);\r\n    if (!selectBook) {\r\n      return;\r\n    }\r\n    const LastSelectedBook = document.getElementsByClassName(\"book-card--active\");\r\n    if (LastSelectedBook[0]) {\r\n      LastSelectedBook[0].classList.remove(\"book-card--active\");\r\n    }\r\n    this.LastSelectedBook = selectBook;\r\n    targetDiv.classList.add(\"book-card--active\");\r\n\r\n    this.bookInfo.setBookInfo(selectBook);\r\n  }\r\n}","'use strict';\r\n\r\nexport class BookCard {\r\n  constructor(bookInfo) {\r\n    // console.log('BookCard');\r\n    this.currentPage = [];\r\n    this.bookInfo = bookInfo;\r\n    const booksList = document.querySelector(\"#booksList\");\r\n    booksList.addEventListener(\"click\", e => \r\n    this.onClickBookCard(e, this.currentPage));\r\n  }\r\n\r\n  setCurrentPage(currentPage) {\r\n    this.currentPage = currentPage;\r\n  }\r\n\r\n  onClickBookCard(e, currentPage) {\r\n    const targetDiv = e.target;\r\n    const id = targetDiv.id;\r\n    const selectBook = currentPage.find(item => item.id === id);\r\n    if (!selectBook) {\r\n      return;\r\n    }\r\n\r\n    const LastSelectedBook = document.getElementsByClassName(\"book-card--active\");\r\n    if (LastSelectedBook[0]) {\r\n      LastSelectedBook[0].classList.remove(\"book-card--active\");\r\n    }\r\n    \r\n    this.LastSelectedBook = selectBook;\r\n    targetDiv.classList.add(\"book-card--active\");\r\n    this.bookInfo.setBookInfo(selectBook);\r\n  }\r\n}","'use strict';\r\nimport skin from './../img/skin.png';\r\n\r\n// import url from \"file!./file.png\"\r\n// import image from '/../src/img/skin.png';\r\nexport class BooksList {\r\n  constructor() {\r\n    // console.log('BooksList');\r\n    this.currentPage = [];\r\n    // const booksList =     document.querySelector(\"#booksList\");\r\n    // const booksShown =    document.querySelector(\"#booksShown\");\r\n    // const booksFound =    document.querySelector(\"#booksFound\");\r\n  }\r\n\r\n  addBooksList(page) {\r\n    page.docs.forEach(item => {\r\n      item.id = item.key.split(\"/\").pop();\r\n    });\r\n    this.currentPage = page.docs;\r\n    const blueBook = `https://www.clker.com/cliparts/c/f/n/A/k/T/book-th.png`;\r\n    const redBook = `https://www.clker.com/cliparts/U/a/w/s/n/V/c-users-public-pictures-sample-pictures-th.png`;\r\n\r\n    const booksListHTML = this.currentPage.reduce((acc, item) => {\r\n      return (acc +\r\n        `<div id=\"${item.id}\" class=\"book-card\">\r\n          <div class=\"book-card__container\">\r\n\r\n            <img class=\"book-card__img\" src=\"${item.cover_i \r\n            ? `https://covers.openlibrary.org/b/id/${item.cover_i}-L.jpg?default=false` \r\n              : `${item.isbn \r\n                ? `https://covers.openlibrary.org/b/isbn/${item.isbn[0]}-L.jpg?default=false`\r\n              : `${skin}`}`\r\n            }\" onError=\"this.src='${skin}'\">\r\n            <div class=\"book-card__header\">\r\n              <span class=\"book-card__title\">${item.title}</span> \r\n              ${item.language ? `<span class=\"book-card__lang\">${item.language.join(\", \")}</span>` : ``}\r\n              ${item.subtitle ? `<div class=\"book-card__subtitle\">${item.subtitle}</div>` : ``}\r\n            </div> \r\n          </div> \r\n        </div>`\r\n      );\r\n    }, \"\");\r\n\r\n    booksList.innerHTML += booksListHTML;\r\n    booksShown.innerHTML = `Shown books: ${this.numShown(page)}`;\r\n    booksFound.innerHTML = `Found books: ${page.numFound}`;\r\n  }\r\n  \r\n  numShown(page) {\r\n    const start = page.start;\r\n    const pageSize = page.docs.length;\r\n    let numberShownBooks;\r\n    if (pageSize == 100) {\r\n      numberShownBooks = start + 100;\r\n    } else {\r\n      numberShownBooks = start + pageSize;\r\n    }\r\n    return numberShownBooks;\r\n  }\r\n}\r\n","'use strict';\r\nimport { Api } from \"./api\";\r\nimport { BookCard } from \"./book-card\";\r\nimport { BooksList } from \"./books-list\";\r\n\r\nexport class Data {\r\n  api = new Api();\r\n  loadedPage = 0;\r\n  countPages = 0;\r\n  pageLoaded = false;\r\n  currentPage = [];\r\n  constructor(bookInfo) {\r\n    // console.log('Data');\r\n    this.bookList = new BooksList();\r\n    this.bookCard = new BookCard(bookInfo);\r\n    this.querry = '';\r\n  }\r\n\r\n  getData(querry, page) {\r\n    if (!querry) {\r\n      return;\r\n    }\r\n    this.pageLoaded = false;\r\n    this.querry = querry;\r\n    this.loadedPage = page;\r\n    if (page == 1)  {\r\n      booksList.innerHTML = ``;\r\n      this.currentPage.length = 0;\r\n      spinnerBig.style.display = \"block\";\r\n    } else if (page > 1) {\r\n      spinnerMini.style.display = 'block';\r\n    }\r\n    this.api.searchBooksQuerry(querry, page).then(page => {\r\n      this.currentPage = this.currentPage.concat(page.docs);\r\n      this.bookCard.setCurrentPage(this.currentPage);\r\n      this.bookList.addBooksList(page);\r\n      this.getCountPages(page);\r\n      this.pageLoaded = true;\r\n      spinnerBig.style.display = \"none\";\r\n      spinnerMini.style.display = 'none';\r\n      // console.log(this.currentPage);\r\n    });\r\n  }\r\n  \r\n  getCountPages(page) {\r\n    const start = page.start;\r\n    const numFound = page.numFound;\r\n    this.countPages = Math.ceil(numFound/100);\r\n    this.loadedPage = Math.ceil((start+100)/100);\r\n  }\r\n  \r\n  addData() {\r\n    if (this.loadedPage < this.countPages) {\r\n      this.pageLoaded = false;\r\n      this.getData(this.querry, this.loadedPage+1)\r\n      // console.log('новые данные ещё нужны');\r\n    }\r\n    if (this.loadedPage == this.countPages) {\r\n      // console.log('новые данные не нужны');\r\n    }\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport class MenuController {\r\n\r\n  constructor(data) {\r\n    // console.log('MenuController');\r\n    const onSearchListBtn =     document.querySelector(\"#onSearchListBtn\");\r\n    const onInfoListBtn =   document.querySelector(\"#onInfoListBtn\");\r\n    const onReadListBtn =   document.querySelector(\"#onReadListBtn\");\r\n    this.leftBlock =   document.querySelector(\"#leftBlock\");\r\n    this.centerBlock =   document.querySelector(\"#centerBlock\");\r\n    this.rightBlock =   document.querySelector(\"#rightBlock\");\r\n    \r\n    // window.addEventListener(`resize`, e => {\r\n    //   console.log(e.target.innerHeight);\r\n    //   console.log(e.target.innerWidth);\r\n    // }, false);\r\n\r\n    onInfoListBtn.addEventListener('click', e => {\r\n      console.log('onInfoListBtn');\r\n      this.leftBlock.style.zIndex = 0;\r\n      this.centerBlock.style.zIndex = 1;\r\n      this.rightBlock.style.zIndex = 0;\r\n    });\r\n\r\n    onReadListBtn.addEventListener('click', e => {\r\n      console.log('onReadListBtn');\r\n      this.leftBlock.style.zIndex = 0;\r\n      this.centerBlock.style.zIndex = 0;\r\n      this.rightBlock.style.zIndex = 1;\r\n    });\r\n\r\n    onSearchListBtn.addEventListener('click', e => {\r\n      console.log('onSearchListBtn');\r\n      this.leftBlock.style.zIndex = 1;\r\n      this.centerBlock.style.zIndex = 0;\r\n      this.rightBlock.style.zIndex = 0;\r\n    });\r\n  }\r\n}\r\n\r\n\r\n","'use strict';\r\n\r\nexport class ScrollController {\r\n  canAddData = true;\r\n  isLoadedNewData = false;\r\n  constructor(data) {\r\n    // console.log('ScrollController');\r\n    // console.log(data);\r\n    this.data = data;\r\n    const scrollBooksList = document.querySelector('#scrollBooksList');\r\n    const spinnerMini = document.querySelector('#spinnerMini');\r\n    scrollBooksList.addEventListener(\"scroll\", (e) => {\r\n      this.isScrolledIntoView(scrollBooksList);\r\n    });\r\n  }\r\n\r\n  isScrolledIntoView(scroll) {\r\n    let docViewTop = scroll.scrollTop; \r\n    let docViewBottom = docViewTop + scroll.offsetHeight;\r\n    let scrollHeigh = scroll.scrollHeight;\r\n    if (docViewBottom + 100 >= scrollHeigh) {\r\n      // scroll in target bottom\r\n      if (this.canAddData && this.data.pageLoaded) {\r\n        this.data.addData();\r\n      } \r\n    }\r\n  }\r\n}","'use strict';\r\n\r\nexport class SearchController {\r\n  constructor(data) {\r\n    // console.log('SearchController');\r\n    this.data = data;\r\n    // const booksList =     document.querySelector(\"#booksList\");\r\n    // const searchInput =   document.querySelector(\"#searchInput\");\r\n    // const searchClear =   document.querySelector(\"#searchClear\");\r\n    // const searchButton =  document.querySelector(\"#searchButton\");\r\n    const debounce = (callback, delay = 250) => {\r\n      let timeoutId\r\n      return (...args) => {\r\n        clearTimeout(timeoutId)\r\n        timeoutId = setTimeout(() => {\r\n          timeoutId = null\r\n          data.getData(searchInput.value, 1);\r\n          callback(...args)\r\n        }, delay)\r\n      }\r\n    }\r\n    const debouncedGreet = debounce(this.onChangeInput, 777);\r\n    searchInput.addEventListener(\"keyup\", (e) => debouncedGreet(e));\r\n    searchButton.addEventListener(\"click\", (e) => this.data.getData(searchInput.value, 1));\r\n    searchClear.addEventListener(\"click\", (e) => (this.onClickClear(e)));\r\n    searchInput.addEventListener(\"keyup\", (e) => {\r\n      let value = e.path[0].value;\r\n      searchClear.style.display = (value == \"\" || undefined) ? 'none' : 'block';\r\n      if(e.code === 'Enter') {\r\n        this.data.getData(searchInput.value, 1);\r\n      }\r\n      if(e.code === 'Backspace' && value == \"\") {\r\n        this.onClearBooksList();\r\n      }\r\n    });\r\n    searchInput.focus();\r\n  }\r\n\r\n  onChangeInput(e) {\r\n    // console.log(`after 777 ms. data(Value) = ${e.target.value}`);\r\n  }\r\n  \r\n  onClickClear(e) {\r\n    searchInput.value = \"\";\r\n    e.currentTarget.style.display = 'none';\r\n    this.onClearBooksList();\r\n  }\r\n\r\n  onClearBooksList() {\r\n    addToReadButton.style.display = 'none';\r\n    booksList.innerHTML = ``;\r\n    bookInfoHeader.innerHTML = ``;\r\n    bookInfoProps.innerHTML = ``;\r\n    booksShown.innerHTML = `Shown books: 0`;\r\n    booksFound.innerHTML = `Found books: 0`;\r\n  }\r\n}\r\n\r\n\r\n","'use strict';\r\nimport skin from './../img/skin.png';\r\n\r\nexport class ReadList {\r\n  books = [];\r\n  BookCount = 0;\r\n  ReadCount = 0;\r\n  constructor() {\r\n    // console.log('ReadList');\r\n    this.readListBookCount = document.getElementById(\"readListBookCount\");\r\n    this.readListReadCount = document.getElementById(\"readListReadCount\");\r\n    this.readListBook = document.getElementById(\"readListBook\");\r\n    this.readListRead = document.getElementById(\"readListRead\");\r\n\r\n  }\r\n\r\n  loadReadList(storage) {\r\n    const myBooks = storage.get(\"myBooks\");\r\n    if (myBooks) { \r\n      this.setReadListHTML(myBooks, false);   // не прочитанные книги\r\n      this.setReadListHTML(myBooks, true);    // прочитанные книги\r\n      this.setListAboutHTML(myBooks)\r\n    } \r\n    storage.show(\"myBooks\");\r\n  }\r\n\r\n  setReadListHTML(myBooks, bool) {\r\n    const blueBook = `https://www.clker.com/cliparts/c/f/n/A/k/T/book-th.png`;\r\n    const redBook = `https://www.clker.com/cliparts/U/a/w/s/n/V/c-users-public-pictures-sample-pictures-th.png`;\r\n    let targetDiv = bool ? this.readListRead : this.readListBook;\r\n\r\n    targetDiv.innerHTML = myBooks\r\n    .sort((prev, next) => {\r\n      if ( prev.title < next.title ) return -1;\r\n      if ( prev.title < next.title ) return 1;\r\n    })\r\n    .filter(item => item.read == bool)\r\n    .map(item => \r\n      `<div data-book-id=\"${item.id}\" class=\"book-card book-card--read-${bool}\">\r\n        <div class=\"book-card__container book-card__container\">\r\n          <img class=\"book-card__img\" src=\"${item.cover_i \r\n            ? `https://covers.openlibrary.org/b/id/${item.cover_i}-L.jpg?default=false` \r\n              : `${item.isbn \r\n                ? `https://covers.openlibrary.org/b/isbn/${item.isbn[0]}-L.jpg?default=false`\r\n              : `${skin}`}`\r\n            }\" onError=\"this.src='${skin}'\">\r\n            <div class=\"book-card__header\">\r\n            <span class=\"book-card__title\">${item.title}</span> \r\n            ${item.language ? `<span class=\"book-card__lang\">${item.language.join(\", \")}</span>` : ``}\r\n            ${item.subtitle && (!bool) ? `<div class=\"book-card__subtitle\">${item.subtitle}</div>` : ``}\r\n            ${item.author_name ? `<div class=\"book-card__author\">${item.author_name.join(\", \")}</div>` : ``}\r\n            <div class=\"book-card__buttons\">\r\n              <button class=\"book-card__button\" id=\"${bool ? `un` : ``}markAsReadButton\">${bool ? `un` : ``}Mark as read</button>\r\n              <button class=\"book-card__button\" id=\"removefromListButton\">Remove from list</button>\r\n            </div>\r\n            </div> \r\n        </div> \r\n      </div>`\r\n    ).join(\"\");\r\n  }\r\n\r\n  setListAboutHTML(myBooks) {\r\n    this.BookCount = myBooks.length;\r\n    this.readListBookCount.innerHTML = \r\n    `<div class=\"read-list__item\" id=\"readListBookCount\">${this.BookCount} books,</div>`;\r\n\r\n    this.ReadCount = myBooks.filter(item => item.read == true).length;\r\n    this.readListReadCount.innerHTML = \r\n    `<div class=\"read-list__item\" id=\"readListBookCount\">${this.ReadCount} read</div>`;\r\n  }\r\n}","'use strict';\r\n\r\nimport { ReadList } from \"./read-list\";\r\n\r\nexport class Storage {\r\n  constructor() {\r\n    // console.log('Storage');\r\n    // this.clear();\r\n    this.readList = new ReadList();\r\n    this.refresh();\r\n  }\r\n\r\n  refresh() {\r\n    this.readList.loadReadList(this);\r\n  }\r\n\r\n\r\n  get(name) {\r\n    // name = \"myBooks\", \"myTheme\"\r\n    return JSON.parse(localStorage.getItem(name))\r\n  }\r\n\r\n  set(name, value) { \r\n    // \"myBooks\" = [{},{},{}]\r\n    // \"myTheme\" = \"dark\"\r\n    localStorage.setItem(name, JSON.stringify(value)); \r\n    this.refresh();\r\n  }\r\n\r\n  clear() {\r\n    console.log('Clear storage');\r\n    localStorage.clear(); \r\n  }\r\n\r\n  show(name) {\r\n    // console.log(`${name} = `, this.get(name));\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport class ToggleTheme {\r\n  theme;\r\n  constructor(storage) {    \r\n    // console.log('ToggleTheme');\r\n    this.storage = storage;\r\n    toggleThemeButton.addEventListener('click', e => this.toggleTheme());\r\n    // localStorage.removeItem(\"myTheme\");\r\n    this.loadTheme();\r\n  }\r\n\r\n  loadTheme() {\r\n    const myTheme = this.storage.get(\"myTheme\");\r\n    if (myTheme == 'light' || myTheme == null) {\r\n      this.theme = 'light';\r\n      sunIcon.style.display = \"block\";\r\n      moonIcon.style.display = \"none\";\r\n    }\r\n    if (myTheme == 'dark') {\r\n      this.theme = 'dark';\r\n      sunIcon.style.display = \"none\";\r\n      moonIcon.style.display = \"block\";\r\n      document.documentElement.setAttribute('theme', 'dark');\r\n    }\r\n  }\r\n\r\n  toggleTheme() {\r\n    // console.log(this.toggleButton.children[0].src);\r\n    if (document.documentElement.hasAttribute('theme')) {\r\n      document.documentElement.removeAttribute('theme');\r\n      this.storage.set(\"myTheme\", \"light\");\r\n      sunIcon.style.display = \"block\";\r\n      moonIcon.style.display = \"none\";\r\n      // this.toggleButton.children[0].src = \"./src/img/sun.png\";\r\n    } else {\r\n      document.documentElement.setAttribute('theme', 'dark');\r\n      this.storage.set(\"myTheme\", \"dark\");\r\n      sunIcon.style.display = \"none\";\r\n      moonIcon.style.display = \"block\";\r\n      // this.toggleButton.children[0].src = \"./src/img/moon.png\";\r\n    }\r\n    this.storage.show(\"myTheme\");\r\n  }\r\n}","'use strict';\r\n\r\nimport { BookInfo } from \"./book-info\";\r\nimport { ButtonsController } from \"./buttons-controller\";\r\nimport { Data } from \"./data\";\r\nimport { MenuController } from \"./menu-controller\";\r\nimport { ScrollController } from \"./scroll-controller\";\r\nimport { SearchController } from \"./search-controller\";\r\nimport { Storage } from \"./storage\";\r\nimport { ToggleTheme } from \"./toggle-theme\";\r\n\r\nlet bookInfo = new BookInfo();\r\n\r\nlet data = new Data(bookInfo);\r\nnew SearchController(data);\r\nnew ScrollController(data);\r\n\r\nlet storage = new Storage();\r\nnew ToggleTheme(storage);\r\nnew ButtonsController(storage, bookInfo);\r\n\r\nnew MenuController();\r\n\r\n"]}