{"version":3,"sources":["src/js/api.js","src/js/book-info.js","src/js/buttons-controller.js","src/js/book-card.js","src/js/books-list.js","src/js/data.js","src/js/menu-controller.js","src/js/scroll-controller.js","src/js/search-controller.js","src/js/read-list.js","src/js/storage.js","src/js/toggle-theme.js","src/js/index.js"],"names":["Api","fullQuerry","url","fetch","mode","response","ok","json","console","error","status","querry","page","bookLinks","blob","BookInfo","bookInfoHeader","document","getElementById","bookInfoProps","storage","message","bookAdded","targetBook","read","myBooks","get","checkBookInStorage","filter","item","id","length","push","pushMessage","set","AddToReadMessage","createElement","classList","add","textContent","style","backgroundColor","addToReadButton","appendChild","setTimeout","remove","book","innerHTML","display","title","subtitle","imageLinks","getImageLinks","loadBookImage","i","addPropsHtml","author_name","join","language","map","getFlagHTML","has_fulltext","first_publish_year","publish_year","propTitle","bookKey","cover_i","isbn","forEach","value","lccn","olid","oclc","api","searchBookImage","then","objectURL","window","URL","createObjectURL","bookPicture","src","catch","ButtonsController","bookInfo","readList","addEventListener","e","addToReadList","trackElement","target","tagName","bookId","parentNode","dataset","onChangeReadList","showBook","divId","object","splice","targetDiv","selectBook","find","LastSelectedBook","getElementsByClassName","setBookInfo","BookCard","currentPage","booksList","querySelector","onClickBookCard","BooksList","docs","key","split","pop","blueBook","redBook","booksListHTML","reduce","acc","skin","booksShown","numShown","booksFound","numFound","start","pageSize","numberShownBooks","Data","bookList","bookCard","pageLoaded","loadedPage","spinnerBig","spinnerMini","searchBooksQuerry","concat","setCurrentPage","addBooksList","getCountPages","countPages","Math","ceil","getData","MenuController","data","onSearchListBtn","onInfoListBtn","onReadListBtn","leftBlock","centerBlock","rightBlock","log","zIndex","ScrollController","scrollBooksList","isScrolledIntoView","scroll","docViewTop","scrollTop","docViewBottom","offsetHeight","scrollHeigh","scrollHeight","canAddData","addData","SearchController","debounce","callback","delay","timeoutId","args","clearTimeout","searchInput","debouncedGreet","onChangeInput","searchButton","searchClear","onClickClear","path","undefined","code","onClearBooksList","focus","currentTarget","ReadList","readListBookCount","readListReadCount","readListBook","readListRead","setReadListHTML","setListAboutHTML","show","bool","sort","prev","next","BookCount","ReadCount","Storage","refresh","loadReadList","name","JSON","parse","localStorage","getItem","setItem","stringify","clear","ToggleTheme","toggleThemeButton","toggleTheme","loadTheme","myTheme","theme","sunIcon","moonIcon","documentElement","setAttribute","hasAttribute","removeAttribute"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IACaA;;;;;;;;;;;;;;;;;;;;;;;iFAKX,iBAAkBC,UAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AACQC,gBAAAA,GADR,mCACiB,IADjB,0CACmDD,UADnD;AAAA;AAAA;AAAA,uBAG2BE,KAAK,CAACD,GAAD,EAAM;AAACE,kBAAAA,IAAI,EAAE;AAAP,iBAAN,CAHhC;;AAAA;AAGUC,gBAAAA,QAHV;;AAAA,qBAIQA,QAAQ,CAACC,EAJjB;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKmBD,QAAQ,CAACE,IAAT,EALnB;;AAAA;AAAA;;AAAA;AAOIC,gBAAAA,OAAO,CAACC,KAAR,mBAAyBP,GAAzB,0BAA4CG,QAAQ,CAACK,MAArD;AAPJ;AAAA;;AAAA;AAAA;AAAA;AASIF,gBAAAA,OAAO,CAACC,KAAR,mBAAyBP,GAAzB;;AATJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;uFAaA,kBAAwBS,MAAxB,EAAgCC,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AACQV,gBAAAA,GADR,mCACiB,IADjB,4CACqDS,MADrD,mBACoEC,IADpE;AAAA;AAAA;AAAA,uBAG2BT,KAAK,CAACD,GAAD,EAAM;AAACE,kBAAAA,IAAI,EAAE;AAAP,iBAAN,CAHhC;;AAAA;AAGUC,gBAAAA,QAHV;;AAAA,qBAIQA,QAAQ,CAACC,EAJjB;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKmBD,QAAQ,CAACE,IAAT,EALnB;;AAAA;AAAA;;AAAA;AAOIC,gBAAAA,OAAO,CAACC,KAAR,mBAAyBP,GAAzB,0BAA4CG,QAAQ,CAACK,MAArD;AAPJ;AAAA;;AAAA;AAAA;AAAA;AASIF,gBAAAA,OAAO,CAACC,KAAR,mBAAyBP,GAAzB;;AATJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;qFAaA,kBAAsBW,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AACQX,gBAAAA,GADR,mCACiB,IADjB,+BACwCW,SADxC,oCACqD,IADrD;AAAA;AAAA;AAAA,uBAGyBV,KAAK,WAAID,GAAJ,GAAW;AAACE,kBAAAA,IAAI,EAAE;AAAP,iBAAX,CAH9B;;AAAA;AAGQC,gBAAAA,QAHR;;AAAA,qBAIQA,QAAQ,CAACC,EAJjB;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKmBD,QAAQ,CAACS,IAAT,EALnB;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAUIN,gBAAAA,OAAO,CAACC,KAAR,mBAAyBP,GAAzB;;AAVJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;AChCF;;;;;;;AAEA;;;;;;;;;;IAGaa;AAKX,sBAAc;AAAA;;AAAA,wCAJD,EAIC;;AAAA,iCAHR,IAAIf,QAAJ,EAGQ;;AAAA,+BAFV,CAEU;;AAAA,wCADD,EACC;;AACZ;AACA,SAAKgB,cAAL,GAAsBC,QAAQ,CAACC,cAAT,CAAwB,gBAAxB,CAAtB;AACA,SAAKC,aAAL,GAAqBF,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAArB;AACD;;;;WAED,uBAAcE,OAAd,EAAuB;AAAA;;AACrB,UAAG,CAACA,OAAJ,EAAa;AACX;AACD;;AACD,UAAIC,OAAO,GAAG,EAAd;AACA,UAAIC,SAAS,GAAG,KAAhB;AACA,WAAKC,UAAL,CAAgBC,IAAhB,GAAuB,KAAvB;AAEA,UAAIC,OAAO,GAAGL,OAAO,CAACM,GAAR,CAAY,SAAZ,CAAd,CARqB,CASrB;;AACA,UAAID,OAAJ,EAAa;AACX,YAAIE,kBAAkB,GAAGF,OAAO,CAC/BG,MADwB,CACjB,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAACC,EAAL,IAAW,KAAI,CAACP,UAAL,CAAgBO,EAA/B;AAAA,SADa,EACsBC,MADtB,GAC+B,CADxD,CADW,CAIX;;AACA,YAAIJ,kBAAJ,EAAwB;AACtBL,UAAAA,SAAS,GAAG,KAAZ;AACAD,UAAAA,OAAO,GAAG,mCAAV;AACD,SAHD,MAGQ;AACNI,UAAAA,OAAO,CAACO,IAAR,CAAa,KAAKT,UAAlB;AACAD,UAAAA,SAAS,GAAG,IAAZ;AACAD,UAAAA,OAAO,GAAG,kCAAV;AACD;AACF,OAbD,MAaO,IAAI,CAACI,OAAL,EAAc;AACnBA,QAAAA,OAAO,GAAG,EAAV;AACAA,QAAAA,OAAO,CAACO,IAAR,CAAa,KAAKT,UAAlB;AACAD,QAAAA,SAAS,GAAG,IAAZ;AACAD,QAAAA,OAAO,GAAG,kCAAV;AACD;;AAED,WAAKY,WAAL,CAAiBX,SAAjB,EAA4BD,OAA5B;AACAD,MAAAA,OAAO,CAACc,GAAR,CAAY,SAAZ,EAAuBT,OAAvB;AACD;;;WAED,qBAAYH,SAAZ,EAAuBD,OAAvB,EAAgC;AAC9B,UAAMc,gBAAgB,GAAGlB,QAAQ,CAACmB,aAAT,CAAuB,KAAvB,CAAzB;AACAD,MAAAA,gBAAgB,CAACE,SAAjB,CAA2BC,GAA3B,CAA+B,SAA/B;AACAH,MAAAA,gBAAgB,CAACI,WAAjB,GAA+BlB,OAA/B;AACAc,MAAAA,gBAAgB,CAACK,KAAjB,CAAuBC,eAAvB,GAAyCnB,SAAS,GAAG,SAAH,GAAe,SAAjE;AACAoB,MAAAA,eAAe,CAACC,WAAhB,CAA4BR,gBAA5B;AACAS,MAAAA,UAAU,CAAC,YAAU;AAACT,QAAAA,gBAAgB,CAACU,MAAjB;AAA0B,OAAtC,EAAwC,IAAxC,CAAV;AACD;;;WAED,qBAAYC,IAAZ,EAAkB;AAAA;AAAA;AAAA;AAAA;;AAChB,WAAKvB,UAAL,GAAkBuB,IAAlB;AACA,WAAK9B,cAAL,CAAoB+B,SAApB;AACA,WAAK5B,aAAL,CAAmB4B,SAAnB;AACAL,MAAAA,eAAe,CAACF,KAAhB,CAAsBQ,OAAtB,GAAgC,OAAhC,CAJgB,CAKhB;AACA;;AACA,WAAKhC,cAAL,CAAoB+B,SAApB,6CAAiED,IAAI,CAACG,KAAtE,WAPgB,CAOwF;;AACxG,UAAIH,IAAI,CAACI,QAAT,EAAmB;AACjB,aAAK/B,aAAL,CAAmB4B,SAAnB,gDAAmED,IAAI,CAACI,QAAxE;AACD;;AACD,WAAK/B,aAAL,CAAmB4B,SAAnB;AACA,WAAKI,UAAL,GAAkB,KAAKC,aAAL,CAAmBN,IAAnB,CAAlB;AACA,WAAKO,aAAL,CAAmB,KAAKF,UAAxB,EAAoC,KAAKG,CAAzC;AACA,WAAKC,YAAL,iCAA6BT,IAAI,CAACU,WAAlC,sDAA6B,kBAAkBC,IAAlB,CAAuB,IAAvB,CAA7B;AACA,WAAKF,YAAL,2CAA0CT,IAAI,CAACY,QAA/C,mDAA0C,eACtCC,GADsC,CAClC,UAAA9B,IAAI;AAAA,eAAI,MAAI,CAAC+B,WAAL,CAAiB/B,IAAjB,IAAyBA,IAA7B;AAAA,OAD8B,EAEvC4B,IAFuC,CAElC,IAFkC,CAA1C;AAGA,WAAKF,YAAL,yBAA0CT,IAAI,CAACe,YAA/C;AACA,WAAKN,YAAL,wBAAyCT,IAAI,CAACgB,kBAA9C;AACA,WAAKP,YAAL,2CAAsCT,IAAI,CAACiB,YAA3C,uDAAsC,mBAAmBN,IAAnB,CAAwB,IAAxB,CAAtC;AACD;;;WAED,sBAAaO,SAAb,EAAwBC,OAAxB,EAAiC;AAC/B,UAAIA,OAAJ,EAAa;AACX,aAAK9C,aAAL,CAAmB4B,SAAnB,6FAEwCiB,SAFxC,oEAGwCC,OAHxC;AAKD;AACF;;;WAED,uBAAcnB,IAAd,EAAoB;AAClB,WAAKQ,CAAL,GAAS,CAAT,CADkB,CACQ;;AAC1B,UAAMH,UAAU,GAAG,EAAnB,CAFkB,CAEQ;;AAE1BL,MAAAA,IAAI,CAACoB,OAAL,IAAgBf,UAAU,CAACnB,IAAX,cAAsBc,IAAI,CAACoB,OAA3B,EAAhB;AACApB,MAAAA,IAAI,CAACqB,IAAL,IAAarB,IAAI,CAACqB,IAAL,CAAUC,OAAV,CAAkB,UAAAC,KAAK;AAAA,eAAIlB,UAAU,CAACnB,IAAX,gBAAwBqC,KAAxB,EAAJ;AAAA,OAAvB,CAAb;AACAvB,MAAAA,IAAI,CAACwB,IAAL,IAAaxB,IAAI,CAACwB,IAAL,CAAUF,OAAV,CAAkB,UAAAC,KAAK;AAAA,eAAIlB,UAAU,CAACnB,IAAX,gBAAwBqC,KAAxB,EAAJ;AAAA,OAAvB,CAAb;AACAvB,MAAAA,IAAI,CAACyB,IAAL,IAAazB,IAAI,CAACyB,IAAL,CAAUH,OAAV,CAAkB,UAAAC,KAAK;AAAA,eAAIlB,UAAU,CAACnB,IAAX,gBAAwBqC,KAAxB,EAAJ;AAAA,OAAvB,CAAb;AACAvB,MAAAA,IAAI,CAAC0B,IAAL,IAAa1B,IAAI,CAAC0B,IAAL,CAAUJ,OAAV,CAAkB,UAAAC,KAAK;AAAA,eAAIlB,UAAU,CAACnB,IAAX,gBAAwBqC,KAAxB,EAAJ;AAAA,OAAvB,CAAb;AACA,aAAOlB,UAAP;AACD;;;WAED,uBAAcA,UAAd,EAA0BG,CAA1B,EAA6B;AAAA;;AAC3B,UAAI,CAACH,UAAU,CAACG,CAAD,CAAX,IAAkBH,UAAU,CAACpB,MAAX,IAAqB,KAAKuB,CAAhD,EAAmD,OADxB,CAE3B;;AACA,WAAKmB,GAAL,CAASC,eAAT,CAAyBvB,UAAU,CAACG,CAAD,CAAnC,EAAwCqB,IAAxC,CAA6C,UAAA7D,IAAI,EAAI;AACnD,YAAI8D,SAAS,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2BjE,IAA3B,CAAhB;AACA,YAAIkE,WAAW,GAAG/D,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAlB;;AACA,YAAI8D,WAAW,CAACC,GAAZ,KAAoB,EAAxB,EAA4B;AAC1BD,UAAAA,WAAW,CAACC,GAAZ,GAAkBL,SAAlB;AACD;AACF,OAND,EAOCM,KAPD,CAOQ,UAAAzE,KAAK,EAAI;AACf;AACA;AACA;AACA,QAAA,MAAI,CAAC6C,CAAL;;AACA,QAAA,MAAI,CAACD,aAAL,CAAmB,MAAI,CAACF,UAAxB,EAAoC,MAAI,CAACG,CAAzC;AACD,OAbD;AAcD,MACH;;;;WACE,qBAAYzB,IAAZ,EAAkB;AAChB;AACA,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,QAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,QAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,IAAI,KAAZ,EAAmBA,IAAI,GAAG,IAAP;AACnB,UAAIA,IAAI,CAACE,MAAL,KAAgB,CAApB,EAAuB;AACvB,sFAAsEF,IAAtE;AACD,MACD;;;;;;;;;AC5KF;;;;;;;;;;;;;;;IAEasD;AAEX,6BAAY/D,OAAZ,EAAqBgE,QAArB,EAA+B;AAAA;;AAAA;;AAAA;;AAC7B;AACA,SAAKhE,OAAL,GAAeA,OAAf;AACA,SAAKgE,QAAL,GAAgBA,QAAhB;AACA,SAAKC,QAAL,GAAgBpE,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CAAhB;AACA,QAAMwB,eAAe,GAAGzB,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CAAxB;AAEAwB,IAAAA,eAAe,CAAC4C,gBAAhB,CAAiC,OAAjC,EAA0C,UAAAC,CAAC;AAAA,aAC3C,KAAI,CAACH,QAAL,CAAcI,aAAd,CAA4B,KAAI,CAACpE,OAAjC,CAD2C;AAAA,KAA3C;AAGA,SAAKiE,QAAL,CAAcC,gBAAd,CAA+B,OAA/B,EAAwC,UAAAC,CAAC;AAAA,aAAI,KAAI,CAACE,YAAL,CAAkBF,CAAlB,CAAJ;AAAA,KAAzC;AACD;;;;WAED,sBAAaA,CAAb,EAAgB;AACd,UAAI1D,IAAI,GAAG0D,CAAC,CAACG,MAAb;;AACA,UAAI7D,IAAI,CAAC8D,OAAL,IAAgB,QAApB,EAA8B;AAC5B;AACA,aAAKC,MAAL,GAAc/D,IAAI,CAACgE,UAAL,CAAgBA,UAAhB,CAA2BA,UAA3B,CAAsCA,UAAtC,CAAiDC,OAAjD,CAAyDF,MAAvE;AACA,aAAKG,gBAAL,CAAsB,KAAKH,MAA3B,EAAmC/D,IAAI,CAACC,EAAxC;AACD;;AACD,UAAID,IAAI,CAAC8D,OAAL,IAAgB,KAApB,EAA2B;AACzB;AACA,aAAKC,MAAL,GAAc/D,IAAI,CAACiE,OAAL,CAAaF,MAA3B;AACA,aAAKI,QAAL,CAAc,KAAKJ,MAAnB,EAA2BL,CAA3B;AACD;AACF;;;WAED,0BAAiBK,MAAjB,EAAyBK,KAAzB,EAAgC;AAC9B,UAAMxE,OAAO,GAAG,KAAKL,OAAL,CAAaM,GAAb,CAAiB,SAAjB,CAAhB;AACAD,MAAAA,OAAO,CAAC2C,OAAR,CAAgB,UAACvC,IAAD,EAAOyB,CAAP,EAAU4C,MAAV,EAAqB;AACnC,YAAIrE,IAAI,CAACC,EAAL,IAAW8D,MAAf,EAAuB;AACrB,cAAIK,KAAK,IAAI,kBAAb,EAAiC;AAC/BpE,YAAAA,IAAI,CAACL,IAAL,GAAY,IAAZ;AACD;;AACD,cAAIyE,KAAK,IAAI,oBAAb,EAAmC;AACjCpE,YAAAA,IAAI,CAACL,IAAL,GAAY,KAAZ;AACD;;AACD,cAAIyE,KAAK,IAAI,sBAAb,EAAqC;AACnCC,YAAAA,MAAM,CAACC,MAAP,CAAc7C,CAAd,EAAiB,CAAjB;AACD;AACF;AACF,OAZD;AAaA,WAAKlC,OAAL,CAAac,GAAb,CAAiB,SAAjB,EAA4BT,OAA5B;AACD;;;WAED,kBAASmE,MAAT,EAAiBL,CAAjB,EAAoB;AAClB,UAAMa,SAAS,GAAGb,CAAC,CAACG,MAApB;AACA,UAAMjE,OAAO,GAAG,KAAKL,OAAL,CAAaM,GAAb,CAAiB,SAAjB,CAAhB;AACA,UAAM2E,UAAU,GAAG5E,OAAO,CAAC6E,IAAR,CAAa,UAAAzE,IAAI;AAAA,eAAIA,IAAI,CAACC,EAAL,IAAW8D,MAAf;AAAA,OAAjB,CAAnB;;AACA,UAAI,CAACS,UAAL,EAAiB;AACf;AACD;;AACD,UAAME,gBAAgB,GAAGtF,QAAQ,CAACuF,sBAAT,CAAgC,mBAAhC,CAAzB;;AACA,UAAID,gBAAgB,CAAC,CAAD,CAApB,EAAyB;AACvBA,QAAAA,gBAAgB,CAAC,CAAD,CAAhB,CAAoBlE,SAApB,CAA8BQ,MAA9B,CAAqC,mBAArC;AACD;;AACD,WAAK0D,gBAAL,GAAwBF,UAAxB;AACAD,MAAAA,SAAS,CAAC/D,SAAV,CAAoBC,GAApB,CAAwB,mBAAxB;AAEA,WAAK8C,QAAL,CAAcqB,WAAd,CAA0BJ,UAA1B;AACD;;;;;;;;AChEH;;;;;;;;;;;;;IAEaK;AACX,oBAAYtB,QAAZ,EAAsB;AAAA;;AAAA;;AACpB;AACA,SAAKuB,WAAL,GAAmB,EAAnB;AACA,SAAKvB,QAAL,GAAgBA,QAAhB;AACA,QAAMwB,SAAS,GAAG3F,QAAQ,CAAC4F,aAAT,CAAuB,YAAvB,CAAlB;AACAD,IAAAA,SAAS,CAACtB,gBAAV,CAA2B,OAA3B,EAAoC,UAAAC,CAAC;AAAA,aACrC,KAAI,CAACuB,eAAL,CAAqBvB,CAArB,EAAwB,KAAI,CAACoB,WAA7B,CADqC;AAAA,KAArC;AAED;;;;WAED,wBAAeA,WAAf,EAA4B;AAC1B,WAAKA,WAAL,GAAmBA,WAAnB;AACD;;;WAED,yBAAgBpB,CAAhB,EAAmBoB,WAAnB,EAAgC;AAC9B,UAAMP,SAAS,GAAGb,CAAC,CAACG,MAApB;AACA,UAAM5D,EAAE,GAAGsE,SAAS,CAACtE,EAArB;AACA,UAAMuE,UAAU,GAAGM,WAAW,CAACL,IAAZ,CAAiB,UAAAzE,IAAI;AAAA,eAAIA,IAAI,CAACC,EAAL,KAAYA,EAAhB;AAAA,OAArB,CAAnB;;AACA,UAAI,CAACuE,UAAL,EAAiB;AACf;AACD;;AAED,UAAME,gBAAgB,GAAGtF,QAAQ,CAACuF,sBAAT,CAAgC,mBAAhC,CAAzB;;AACA,UAAID,gBAAgB,CAAC,CAAD,CAApB,EAAyB;AACvBA,QAAAA,gBAAgB,CAAC,CAAD,CAAhB,CAAoBlE,SAApB,CAA8BQ,MAA9B,CAAqC,mBAArC;AACD;;AAED,WAAK0D,gBAAL,GAAwBF,UAAxB;AACAD,MAAAA,SAAS,CAAC/D,SAAV,CAAoBC,GAApB,CAAwB,mBAAxB;AACA,WAAK8C,QAAL,CAAcqB,WAAd,CAA0BJ,UAA1B;AACD;;;;;;;;;;AChCH;;;;;;;AACA;;;;;;;;;;AAEA;AACA;IACaU;AACX,uBAAc;AAAA;;AACZ;AACA,SAAKJ,WAAL,GAAmB,EAAnB,CAFY,CAGZ;AACA;AACA;AACD;;;;WAED,sBAAa/F,IAAb,EAAmB;AACjBA,MAAAA,IAAI,CAACoG,IAAL,CAAU5C,OAAV,CAAkB,UAAAvC,IAAI,EAAI;AACxBA,QAAAA,IAAI,CAACC,EAAL,GAAUD,IAAI,CAACoF,GAAL,CAASC,KAAT,CAAe,GAAf,EAAoBC,GAApB,EAAV;AACD,OAFD;AAGA,WAAKR,WAAL,GAAmB/F,IAAI,CAACoG,IAAxB;AACA,UAAMI,QAAQ,2DAAd;AACA,UAAMC,OAAO,8FAAb;AAEA,UAAMC,aAAa,GAAG,KAAKX,WAAL,CAAiBY,MAAjB,CAAwB,UAACC,GAAD,EAAM3F,IAAN,EAAe;AAC3D,eAAQ2F,GAAG,uBACG3F,IAAI,CAACC,EADR,wIAI8BD,IAAI,CAACqC,OAAL,iDACMrC,IAAI,CAACqC,OADX,sCAE5BrC,IAAI,CAACsC,IAAL,mDACwCtC,IAAI,CAACsC,IAAL,CAAU,CAAV,CADxC,sCAEAsD,aAFA,CAF4B,CAJ9B,oCASmBA,aATnB,iHAW8B5F,IAAI,CAACoB,KAXnC,qCAYDpB,IAAI,CAAC6B,QAAL,6CAAiD7B,IAAI,CAAC6B,QAAL,CAAcD,IAAd,CAAmB,IAAnB,CAAjD,iBAZC,6BAaD5B,IAAI,CAACqB,QAAL,gDAAoDrB,IAAI,CAACqB,QAAzD,gBAbC,6DAAX;AAkBD,OAnBqB,EAmBnB,EAnBmB,CAAtB;AAqBA0D,MAAAA,SAAS,CAAC7D,SAAV,IAAuBuE,aAAvB;AACAI,MAAAA,UAAU,CAAC3E,SAAX,0BAAuC,KAAK4E,QAAL,CAAc/G,IAAd,CAAvC;AACAgH,MAAAA,UAAU,CAAC7E,SAAX,0BAAuCnC,IAAI,CAACiH,QAA5C;AACD;;;WAED,kBAASjH,IAAT,EAAe;AACb,UAAMkH,KAAK,GAAGlH,IAAI,CAACkH,KAAnB;AACA,UAAMC,QAAQ,GAAGnH,IAAI,CAACoG,IAAL,CAAUjF,MAA3B;AACA,UAAIiG,gBAAJ;;AACA,UAAID,QAAQ,IAAI,GAAhB,EAAqB;AACnBC,QAAAA,gBAAgB,GAAGF,KAAK,GAAG,GAA3B;AACD,OAFD,MAEO;AACLE,QAAAA,gBAAgB,GAAGF,KAAK,GAAGC,QAA3B;AACD;;AACD,aAAOC,gBAAP;AACD;;;;;;;;AC1DH;;;;;;;AACA;;AACA;;AACA;;;;;;;;;;IAEaC;AAMX,gBAAY7C,QAAZ,EAAsB;AAAA;;AAAA,iCALhB,IAAIpF,QAAJ,EAKgB;;AAAA,wCAJT,CAIS;;AAAA,wCAHT,CAGS;;AAAA,wCAFT,KAES;;AAAA,yCADR,EACQ;;AACpB;AACA,SAAKkI,QAAL,GAAgB,IAAInB,oBAAJ,EAAhB;AACA,SAAKoB,QAAL,GAAgB,IAAIzB,kBAAJ,CAAatB,QAAb,CAAhB;AACA,SAAKzE,MAAL,GAAc,EAAd;AACD;;;;WAED,iBAAQA,MAAR,EAAgBC,IAAhB,EAAsB;AAAA;;AACpB,UAAI,CAACD,MAAL,EAAa;AACX;AACD;;AACD,WAAKyH,UAAL,GAAkB,KAAlB;AACA,WAAKzH,MAAL,GAAcA,MAAd;AACA,WAAK0H,UAAL,GAAkBzH,IAAlB;;AACA,UAAIA,IAAI,IAAI,CAAZ,EAAgB;AACdgG,QAAAA,SAAS,CAAC7D,SAAV;AACA,aAAK4D,WAAL,CAAiB5E,MAAjB,GAA0B,CAA1B;AACAuG,QAAAA,UAAU,CAAC9F,KAAX,CAAiBQ,OAAjB,GAA2B,OAA3B;AACD,OAJD,MAIO,IAAIpC,IAAI,GAAG,CAAX,EAAc;AACnB2H,QAAAA,WAAW,CAAC/F,KAAZ,CAAkBQ,OAAlB,GAA4B,OAA5B;AACD;;AACD,WAAKyB,GAAL,CAAS+D,iBAAT,CAA2B7H,MAA3B,EAAmCC,IAAnC,EAAyC+D,IAAzC,CAA8C,UAAA/D,IAAI,EAAI;AACpD,QAAA,KAAI,CAAC+F,WAAL,GAAmB,KAAI,CAACA,WAAL,CAAiB8B,MAAjB,CAAwB7H,IAAI,CAACoG,IAA7B,CAAnB;;AACA,QAAA,KAAI,CAACmB,QAAL,CAAcO,cAAd,CAA6B,KAAI,CAAC/B,WAAlC;;AACA,QAAA,KAAI,CAACuB,QAAL,CAAcS,YAAd,CAA2B/H,IAA3B;;AACA,QAAA,KAAI,CAACgI,aAAL,CAAmBhI,IAAnB;;AACA,QAAA,KAAI,CAACwH,UAAL,GAAkB,IAAlB;AACAE,QAAAA,UAAU,CAAC9F,KAAX,CAAiBQ,OAAjB,GAA2B,MAA3B;AACAuF,QAAAA,WAAW,CAAC/F,KAAZ,CAAkBQ,OAAlB,GAA4B,MAA5B,CAPoD,CAQpD;AACD,OATD;AAUD;;;WAED,uBAAcpC,IAAd,EAAoB;AAClB,UAAMkH,KAAK,GAAGlH,IAAI,CAACkH,KAAnB;AACA,UAAMD,QAAQ,GAAGjH,IAAI,CAACiH,QAAtB;AACA,WAAKgB,UAAL,GAAkBC,IAAI,CAACC,IAAL,CAAUlB,QAAQ,GAAC,GAAnB,CAAlB;AACA,WAAKQ,UAAL,GAAkBS,IAAI,CAACC,IAAL,CAAU,CAACjB,KAAK,GAAC,GAAP,IAAY,GAAtB,CAAlB;AACD;;;WAED,mBAAU;AACR,UAAI,KAAKO,UAAL,GAAkB,KAAKQ,UAA3B,EAAuC;AACrC,aAAKT,UAAL,GAAkB,KAAlB;AACA,aAAKY,OAAL,CAAa,KAAKrI,MAAlB,EAA0B,KAAK0H,UAAL,GAAgB,CAA1C,EAFqC,CAGrC;AACD;;AACD,UAAI,KAAKA,UAAL,IAAmB,KAAKQ,UAA5B,EAAwC,CACtC;AACD;AACF;;;;;;;;AC5DH;;;;;;;;;IAEaI,iBAEX,wBAAYC,IAAZ,EAAkB;AAAA;;AAAA;;AAChB;AACA,MAAMC,eAAe,GAAOlI,QAAQ,CAAC4F,aAAT,CAAuB,kBAAvB,CAA5B;AACA,MAAMuC,aAAa,GAAKnI,QAAQ,CAAC4F,aAAT,CAAuB,gBAAvB,CAAxB;AACA,MAAMwC,aAAa,GAAKpI,QAAQ,CAAC4F,aAAT,CAAuB,gBAAvB,CAAxB;AACA,OAAKyC,SAAL,GAAmBrI,QAAQ,CAAC4F,aAAT,CAAuB,YAAvB,CAAnB;AACA,OAAK0C,WAAL,GAAqBtI,QAAQ,CAAC4F,aAAT,CAAuB,cAAvB,CAArB;AACA,OAAK2C,UAAL,GAAoBvI,QAAQ,CAAC4F,aAAT,CAAuB,aAAvB,CAApB,CAPgB,CAShB;AACA;AACA;AACA;;AAEAuC,EAAAA,aAAa,CAAC9D,gBAAd,CAA+B,OAA/B,EAAwC,UAAAC,CAAC,EAAI;AAC3C/E,IAAAA,OAAO,CAACiJ,GAAR,CAAY,eAAZ;AACA,IAAA,KAAI,CAACH,SAAL,CAAe9G,KAAf,CAAqBkH,MAArB,GAA8B,CAA9B;AACA,IAAA,KAAI,CAACH,WAAL,CAAiB/G,KAAjB,CAAuBkH,MAAvB,GAAgC,CAAhC;AACA,IAAA,KAAI,CAACF,UAAL,CAAgBhH,KAAhB,CAAsBkH,MAAtB,GAA+B,CAA/B;AACD,GALD;AAOAL,EAAAA,aAAa,CAAC/D,gBAAd,CAA+B,OAA/B,EAAwC,UAAAC,CAAC,EAAI;AAC3C/E,IAAAA,OAAO,CAACiJ,GAAR,CAAY,eAAZ;AACA,IAAA,KAAI,CAACH,SAAL,CAAe9G,KAAf,CAAqBkH,MAArB,GAA8B,CAA9B;AACA,IAAA,KAAI,CAACH,WAAL,CAAiB/G,KAAjB,CAAuBkH,MAAvB,GAAgC,CAAhC;AACA,IAAA,KAAI,CAACF,UAAL,CAAgBhH,KAAhB,CAAsBkH,MAAtB,GAA+B,CAA/B;AACD,GALD;AAOAP,EAAAA,eAAe,CAAC7D,gBAAhB,CAAiC,OAAjC,EAA0C,UAAAC,CAAC,EAAI;AAC7C/E,IAAAA,OAAO,CAACiJ,GAAR,CAAY,iBAAZ;AACA,IAAA,KAAI,CAACH,SAAL,CAAe9G,KAAf,CAAqBkH,MAArB,GAA8B,CAA9B;AACA,IAAA,KAAI,CAACH,WAAL,CAAiB/G,KAAjB,CAAuBkH,MAAvB,GAAgC,CAAhC;AACA,IAAA,KAAI,CAACF,UAAL,CAAgBhH,KAAhB,CAAsBkH,MAAtB,GAA+B,CAA/B;AACD,GALD;AAMD;;;;ACtCH;;;;;;;;;;;;;;;IAEaC;AAGX,4BAAYT,IAAZ,EAAkB;AAAA;;AAAA;;AAAA,wCAFL,IAEK;;AAAA,6CADA,KACA;;AAChB;AACA;AACA,SAAKA,IAAL,GAAYA,IAAZ;AACA,QAAMU,eAAe,GAAG3I,QAAQ,CAAC4F,aAAT,CAAuB,kBAAvB,CAAxB;AACA,QAAM0B,WAAW,GAAGtH,QAAQ,CAAC4F,aAAT,CAAuB,cAAvB,CAApB;AACA+C,IAAAA,eAAe,CAACtE,gBAAhB,CAAiC,QAAjC,EAA2C,UAACC,CAAD,EAAO;AAChD,MAAA,KAAI,CAACsE,kBAAL,CAAwBD,eAAxB;AACD,KAFD;AAGD;;;;WAED,4BAAmBE,MAAnB,EAA2B;AACzB,UAAIC,UAAU,GAAGD,MAAM,CAACE,SAAxB;AACA,UAAIC,aAAa,GAAGF,UAAU,GAAGD,MAAM,CAACI,YAAxC;AACA,UAAIC,WAAW,GAAGL,MAAM,CAACM,YAAzB;;AACA,UAAIH,aAAa,GAAG,GAAhB,IAAuBE,WAA3B,EAAwC;AACtC;AACA,YAAI,KAAKE,UAAL,IAAmB,KAAKnB,IAAL,CAAUd,UAAjC,EAA6C;AAC3C,eAAKc,IAAL,CAAUoB,OAAV;AACD;AACF;AACF;;;;;;;;AC1BH;;;;;;;;;;;;;IAEaC;AACX,4BAAYrB,IAAZ,EAAkB;AAAA;;AAAA;;AAChB;AACA,SAAKA,IAAL,GAAYA,IAAZ,CAFgB,CAGhB;AACA;AACA;AACA;;AACA,QAAMsB,QAAQ,GAAG,SAAXA,QAAW,CAACC,QAAD,EAA2B;AAAA,UAAhBC,KAAgB,uEAAR,GAAQ;AAC1C,UAAIC,SAAJ;AACA,aAAO,YAAa;AAAA,0CAATC,IAAS;AAATA,UAAAA,IAAS;AAAA;;AAClBC,QAAAA,YAAY,CAACF,SAAD,CAAZ;AACAA,QAAAA,SAAS,GAAG/H,UAAU,CAAC,YAAM;AAC3B+H,UAAAA,SAAS,GAAG,IAAZ;AACAzB,UAAAA,IAAI,CAACF,OAAL,CAAa8B,WAAW,CAACzG,KAAzB,EAAgC,CAAhC;AACAoG,UAAAA,QAAQ,MAAR,SAAYG,IAAZ;AACD,SAJqB,EAInBF,KAJmB,CAAtB;AAKD,OAPD;AAQD,KAVD;;AAWA,QAAMK,cAAc,GAAGP,QAAQ,CAAC,KAAKQ,aAAN,EAAqB,GAArB,CAA/B;AACAF,IAAAA,WAAW,CAACxF,gBAAZ,CAA6B,OAA7B,EAAsC,UAACC,CAAD;AAAA,aAAOwF,cAAc,CAACxF,CAAD,CAArB;AAAA,KAAtC;AACA0F,IAAAA,YAAY,CAAC3F,gBAAb,CAA8B,OAA9B,EAAuC,UAACC,CAAD;AAAA,aAAO,KAAI,CAAC2D,IAAL,CAAUF,OAAV,CAAkB8B,WAAW,CAACzG,KAA9B,EAAqC,CAArC,CAAP;AAAA,KAAvC;AACA6G,IAAAA,WAAW,CAAC5F,gBAAZ,CAA6B,OAA7B,EAAsC,UAACC,CAAD;AAAA,aAAQ,KAAI,CAAC4F,YAAL,CAAkB5F,CAAlB,CAAR;AAAA,KAAtC;AACAuF,IAAAA,WAAW,CAACxF,gBAAZ,CAA6B,OAA7B,EAAsC,UAACC,CAAD,EAAO;AAC3C,UAAIlB,KAAK,GAAGkB,CAAC,CAAC6F,IAAF,CAAO,CAAP,EAAU/G,KAAtB;AACA6G,MAAAA,WAAW,CAAC1I,KAAZ,CAAkBQ,OAAlB,GAA6BqB,KAAK,IAAI,EAAT,IAAegH,SAAhB,GAA6B,MAA7B,GAAsC,OAAlE;;AACA,UAAG9F,CAAC,CAAC+F,IAAF,KAAW,OAAd,EAAuB;AACrB,QAAA,KAAI,CAACpC,IAAL,CAAUF,OAAV,CAAkB8B,WAAW,CAACzG,KAA9B,EAAqC,CAArC;AACD;;AACD,UAAGkB,CAAC,CAAC+F,IAAF,KAAW,WAAX,IAA0BjH,KAAK,IAAI,EAAtC,EAA0C;AACxC,QAAA,KAAI,CAACkH,gBAAL;AACD;AACF,KATD;AAUAT,IAAAA,WAAW,CAACU,KAAZ;AACD;;;;WAED,uBAAcjG,CAAd,EAAiB,CACf;AACD;;;WAED,sBAAaA,CAAb,EAAgB;AACduF,MAAAA,WAAW,CAACzG,KAAZ,GAAoB,EAApB;AACAkB,MAAAA,CAAC,CAACkG,aAAF,CAAgBjJ,KAAhB,CAAsBQ,OAAtB,GAAgC,MAAhC;AACA,WAAKuI,gBAAL;AACD;;;WAED,4BAAmB;AACjB7I,MAAAA,eAAe,CAACF,KAAhB,CAAsBQ,OAAtB,GAAgC,MAAhC;AACA4D,MAAAA,SAAS,CAAC7D,SAAV;AACA/B,MAAAA,cAAc,CAAC+B,SAAf;AACA5B,MAAAA,aAAa,CAAC4B,SAAd;AACA2E,MAAAA,UAAU,CAAC3E,SAAX;AACA6E,MAAAA,UAAU,CAAC7E,SAAX;AACD;;;;;;;;ACvDH;;;;;;;AACA;;;;;;;;;;;;IAEa2I;AAIX,sBAAc;AAAA;;AAAA,mCAHN,EAGM;;AAAA,uCAFF,CAEE;;AAAA,uCADF,CACE;;AACZ;AACA,SAAKC,iBAAL,GAAyB1K,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAzB;AACA,SAAK0K,iBAAL,GAAyB3K,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAzB;AACA,SAAK2K,YAAL,GAAoB5K,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CAApB;AACA,SAAK4K,YAAL,GAAoB7K,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CAApB;AAED;;;;WAED,sBAAaE,OAAb,EAAsB;AACpB,UAAMK,OAAO,GAAGL,OAAO,CAACM,GAAR,CAAY,SAAZ,CAAhB;;AACA,UAAID,OAAJ,EAAa;AACX,aAAKsK,eAAL,CAAqBtK,OAArB,EAA8B,KAA9B,EADW,CAC6B;;AACxC,aAAKsK,eAAL,CAAqBtK,OAArB,EAA8B,IAA9B,EAFW,CAE6B;;AACxC,aAAKuK,gBAAL,CAAsBvK,OAAtB;AACD;;AACDL,MAAAA,OAAO,CAAC6K,IAAR,CAAa,SAAb;AACD;;;WAED,yBAAgBxK,OAAhB,EAAyByK,IAAzB,EAA+B;AAC7B,UAAM9E,QAAQ,2DAAd;AACA,UAAMC,OAAO,8FAAb;AACA,UAAIjB,SAAS,GAAG8F,IAAI,GAAG,KAAKJ,YAAR,GAAuB,KAAKD,YAAhD;AAEAzF,MAAAA,SAAS,CAACrD,SAAV,GAAsBtB,OAAO,CAC5B0K,IADqB,CAChB,UAACC,IAAD,EAAOC,IAAP,EAAgB;AACpB,YAAKD,IAAI,CAACnJ,KAAL,GAAaoJ,IAAI,CAACpJ,KAAvB,EAA+B,OAAO,CAAC,CAAR;AAC/B,YAAKmJ,IAAI,CAACnJ,KAAL,GAAaoJ,IAAI,CAACpJ,KAAvB,EAA+B,OAAO,CAAP;AAChC,OAJqB,EAKrBrB,MALqB,CAKd,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACL,IAAL,IAAa0K,IAAjB;AAAA,OALU,EAMrBvI,GANqB,CAMjB,UAAA9B,IAAI;AAAA,6CACeA,IAAI,CAACC,EADpB,kDAC4DoK,IAD5D,mIAGgCrK,IAAI,CAACqC,OAAL,iDACQrC,IAAI,CAACqC,OADb,sCAE1BrC,IAAI,CAACsC,IAAL,mDACwCtC,IAAI,CAACsC,IAAL,CAAU,CAAV,CADxC,sCAEAsD,aAFA,CAF0B,CAHhC,oCAQuBA,aARvB,+GAUgC5F,IAAI,CAACoB,KAVrC,mCAWCpB,IAAI,CAAC6B,QAAL,6CAAiD7B,IAAI,CAAC6B,QAAL,CAAcD,IAAd,CAAmB,IAAnB,CAAjD,iBAXD,2BAYC5B,IAAI,CAACqB,QAAL,IAAkB,CAACgJ,IAAnB,gDAA+DrK,IAAI,CAACqB,QAApE,gBAZD,2BAaCrB,IAAI,CAAC2B,WAAL,8CAAqD3B,IAAI,CAAC2B,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAArD,gBAbD,sHAeyCyI,IAAI,YAf7C,gCAe8EA,IAAI,YAflF;AAAA,OANa,EA2BpBzI,IA3BoB,CA2Bf,EA3Be,CAAtB;AA4BD;;;WAED,0BAAiBhC,OAAjB,EAA0B;AACxB,WAAK6K,SAAL,GAAiB7K,OAAO,CAACM,MAAzB;AACA,WAAK4J,iBAAL,CAAuB5I,SAAvB,qEACuD,KAAKuJ,SAD5D;AAGA,WAAKC,SAAL,GAAiB9K,OAAO,CAACG,MAAR,CAAe,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACL,IAAL,IAAa,IAAjB;AAAA,OAAnB,EAA0CO,MAA3D;AACA,WAAK6J,iBAAL,CAAuB7I,SAAvB,qEACuD,KAAKwJ,SAD5D;AAED;;;;;;;;ACrEH;;;;;;;AAEA;;;;;;;;IAEaC;AACX,qBAAc;AAAA;;AACZ;AACA;AACA,SAAKnH,QAAL,GAAgB,IAAIqG,kBAAJ,EAAhB;AACA,SAAKe,OAAL;AACD;;;;WAED,mBAAU;AACR,WAAKpH,QAAL,CAAcqH,YAAd,CAA2B,IAA3B;AACD;;;WAGD,aAAIC,IAAJ,EAAU;AACR;AACA,aAAOC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBJ,IAArB,CAAX,CAAP;AACD;;;WAED,aAAIA,IAAJ,EAAUtI,KAAV,EAAiB;AACf;AACA;AACAyI,MAAAA,YAAY,CAACE,OAAb,CAAqBL,IAArB,EAA2BC,IAAI,CAACK,SAAL,CAAe5I,KAAf,CAA3B;AACA,WAAKoI,OAAL;AACD;;;WAED,iBAAQ;AACNjM,MAAAA,OAAO,CAACiJ,GAAR,CAAY,eAAZ;AACAqD,MAAAA,YAAY,CAACI,KAAb;AACD;;;WAED,cAAKP,IAAL,EAAW,CACT;AACD;;;;;;;;ACpCH;;;;;;;;;;;;;;;IAEaQ;AAEX,uBAAY/L,OAAZ,EAAqB;AAAA;;AAAA;;AAAA;;AACnB;AACA,SAAKA,OAAL,GAAeA,OAAf;AACAgM,IAAAA,iBAAiB,CAAC9H,gBAAlB,CAAmC,OAAnC,EAA4C,UAAAC,CAAC;AAAA,aAAI,KAAI,CAAC8H,WAAL,EAAJ;AAAA,KAA7C,EAHmB,CAInB;;AACA,SAAKC,SAAL;AACD;;;;WAED,qBAAY;AACV,UAAMC,OAAO,GAAG,KAAKnM,OAAL,CAAaM,GAAb,CAAiB,SAAjB,CAAhB;;AACA,UAAI6L,OAAO,IAAI,OAAX,IAAsBA,OAAO,IAAI,IAArC,EAA2C;AACzC,aAAKC,KAAL,GAAa,OAAb;AACAC,QAAAA,OAAO,CAACjL,KAAR,CAAcQ,OAAd,GAAwB,OAAxB;AACA0K,QAAAA,QAAQ,CAAClL,KAAT,CAAeQ,OAAf,GAAyB,MAAzB;AACD;;AACD,UAAIuK,OAAO,IAAI,MAAf,EAAuB;AACrB,aAAKC,KAAL,GAAa,MAAb;AACAC,QAAAA,OAAO,CAACjL,KAAR,CAAcQ,OAAd,GAAwB,MAAxB;AACA0K,QAAAA,QAAQ,CAAClL,KAAT,CAAeQ,OAAf,GAAyB,OAAzB;AACA/B,QAAAA,QAAQ,CAAC0M,eAAT,CAAyBC,YAAzB,CAAsC,OAAtC,EAA+C,MAA/C;AACD;AACF;;;WAED,uBAAc;AACZ;AACA,UAAI3M,QAAQ,CAAC0M,eAAT,CAAyBE,YAAzB,CAAsC,OAAtC,CAAJ,EAAoD;AAClD5M,QAAAA,QAAQ,CAAC0M,eAAT,CAAyBG,eAAzB,CAAyC,OAAzC;AACA,aAAK1M,OAAL,CAAac,GAAb,CAAiB,SAAjB,EAA4B,OAA5B;AACAuL,QAAAA,OAAO,CAACjL,KAAR,CAAcQ,OAAd,GAAwB,OAAxB;AACA0K,QAAAA,QAAQ,CAAClL,KAAT,CAAeQ,OAAf,GAAyB,MAAzB,CAJkD,CAKlD;AACD,OAND,MAMO;AACL/B,QAAAA,QAAQ,CAAC0M,eAAT,CAAyBC,YAAzB,CAAsC,OAAtC,EAA+C,MAA/C;AACA,aAAKxM,OAAL,CAAac,GAAb,CAAiB,SAAjB,EAA4B,MAA5B;AACAuL,QAAAA,OAAO,CAACjL,KAAR,CAAcQ,OAAd,GAAwB,MAAxB;AACA0K,QAAAA,QAAQ,CAAClL,KAAT,CAAeQ,OAAf,GAAyB,OAAzB,CAJK,CAKL;AACD;;AACD,WAAK5B,OAAL,CAAa6K,IAAb,CAAkB,SAAlB;AACD;;;;;;;;AC3CH;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAI7G,QAAQ,GAAG,IAAIrE,kBAAJ,EAAf;AAEA,IAAImI,IAAI,GAAG,IAAIjB,UAAJ,CAAS7C,QAAT,CAAX;AACA,IAAImF,kCAAJ,CAAqBrB,IAArB;AACA,IAAIS,kCAAJ,CAAqBT,IAArB;AAEA,IAAI9H,OAAO,GAAG,IAAIoL,gBAAJ,EAAd;AACA,IAAIW,wBAAJ,CAAgB/L,OAAhB;AACA,IAAI+D,oCAAJ,CAAsB/D,OAAtB,EAA+BgE,QAA/B;AAEA,IAAI6D,8BAAJ","file":"js.042d6f07.js","sourceRoot":"..","sourcesContent":["'use strict';\r\nexport class Api {\r\n  #apiUrlSearch = `https://openlibrary.org`;\r\n  #apiUrlImage = `https://covers.openlibrary.org`;\r\n  #imageSize = `L`;\r\n\r\n  async searchBooks(fullQuerry) {\r\n    const url = `${this.#apiUrlSearch}/search.json?${fullQuerry}`;\r\n    try {\r\n      const response = await fetch(url, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.json();\r\n      }\r\n      console.error(`Request ${url} failed with ${response.status}`)\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error)\r\n    }\r\n  }\r\n\r\n  async searchBooksQuerry(querry, page) {\r\n    const url = `${this.#apiUrlSearch}/search.json?q=${querry}&page=${page}`;\r\n    try {\r\n      const response = await fetch(url, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.json();\r\n      }\r\n      console.error(`Request ${url} failed with ${response.status}`)\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error)\r\n    }\r\n  }\r\n\r\n  async searchBookImage(bookLinks) {\r\n    const url = `${this.#apiUrlImage}/b/${bookLinks}-${this.#imageSize}.jpg?default=false`;\r\n    try {\r\n      let response = await fetch(`${url}`, {mode: 'cors'});\r\n      if (response.ok) {\r\n        return await response.blob();\r\n      } else {\r\n      // console.error(`Request ${url} failed with ${response.status}`)\r\n      }\r\n    } catch (error) {\r\n      console.error(`Request ${url} failed with error`, error);\r\n    }\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport { Api } from \"./api\";\r\n\r\n\r\nexport class BookInfo {\r\n  targetBook = [];\r\n  api = new Api();\r\n  i = 0;\r\n  imageLinks = [];\r\n  constructor() {\r\n    // console.log('BookInfo');\r\n    this.bookInfoHeader = document.getElementById(\"bookInfoHeader\");\r\n    this.bookInfoProps = document.getElementById(\"bookInfoProps\");\r\n  }\r\n\r\n  addToReadList(storage) {\r\n    if(!storage) {\r\n      return;\r\n    }\r\n    let message = '';\r\n    let bookAdded = false;\r\n    this.targetBook.read = false;\r\n\r\n    let myBooks = storage.get(\"myBooks\");\r\n    // console.log(myBooks);\r\n    if (myBooks) {\r\n      let checkBookInStorage = myBooks\r\n      .filter(item => item.id == this.targetBook.id).length > 0;\r\n      \r\n      // console.log(`book \"${this.targetBook.title}\" in storage? = ` + checkBookInStorage);\r\n      if (checkBookInStorage) {\r\n        bookAdded = false;\r\n        message = \"This book is already in Read List\";\r\n      } else  {\r\n        myBooks.push(this.targetBook);\r\n        bookAdded = true;\r\n        message = \"This book was added in Read List\";\r\n      } \r\n    } else if (!myBooks) {\r\n      myBooks = [];\r\n      myBooks.push(this.targetBook);\r\n      bookAdded = true;\r\n      message = \"This book was added in Read List\";\r\n    }\r\n\r\n    this.pushMessage(bookAdded, message);\r\n    storage.set(\"myBooks\", myBooks);\r\n  }\r\n\r\n  pushMessage(bookAdded, message) {\r\n    const AddToReadMessage = document.createElement('div');\r\n    AddToReadMessage.classList.add('message');\r\n    AddToReadMessage.textContent = message;\r\n    AddToReadMessage.style.backgroundColor = bookAdded ? '#c6fdcd' : '#fdc6c6';\r\n    addToReadButton.appendChild(AddToReadMessage);  \r\n    setTimeout(function(){AddToReadMessage.remove()}, 2000);\r\n  }\r\n\r\n  setBookInfo(book) {\r\n    this.targetBook = book;\r\n    this.bookInfoHeader.innerHTML = ``;\r\n    this.bookInfoProps.innerHTML = ``;\r\n    addToReadButton.style.display = \"block\";\r\n    // this.bookInfoProps.innerHTML += book.title ? `<h2 class=\"book-info__title\">${book.title}</h2>` : ``; // var 3\r\n    // book.title && (this.bookInfoProps.innerHTML += `<h3 class=\"book-info__title\">${book.title}</h3>`);   // var 2\r\n    this.bookInfoHeader.innerHTML += `<h2 class=\"book-info__title\">${book.title}</h2>`;                     // var 1\r\n    if (book.subtitle) {\r\n      this.bookInfoProps.innerHTML += `<h3 class=\"book-info__subtitle\">${book.subtitle}</h3>` \r\n    }\r\n    this.bookInfoProps.innerHTML += `<img class=\"book-info__img\" id=\"bookPicture\"></img>`; \r\n    this.imageLinks = this.getImageLinks(book);\r\n    this.loadBookImage(this.imageLinks, this.i);\r\n    this.addPropsHtml(`Author:`, book.author_name?.join(\", \"));\r\n    this.addPropsHtml(`Languages available:`, book.language\r\n      ?.map(item => this.getFlagHTML(item) + item)\r\n      .join(\", \"));\r\n    this.addPropsHtml(`Full text available:`, book.has_fulltext);\r\n    this.addPropsHtml(`First publish year:`, book.first_publish_year);\r\n    this.addPropsHtml(`Years published:`, book.publish_year?.join(\", \"));\r\n  }\r\n\r\n  addPropsHtml(propTitle, bookKey) {\r\n    if (bookKey) {\r\n      this.bookInfoProps.innerHTML +=  \r\n      `<div class=\"book-info__prop\">\r\n        <span class=\"book-info__prop-title\">${propTitle}</span>\r\n        <span class=\"book-info__prop-value\">${bookKey}</span>\r\n      </div>`\r\n    }\r\n  }\r\n\r\n  getImageLinks(book) {\r\n    this.i = 0;               // индекс первого искомого элемента в массиве картинкок\r\n    const imageLinks = [];    // Все возможные части ссылок на картинки\r\n\r\n    book.cover_i && imageLinks.push(`id/${book.cover_i}`);\r\n    book.isbn && book.isbn.forEach(value => imageLinks.push(`isbn/${value}`));\r\n    book.lccn && book.lccn.forEach(value => imageLinks.push(`lccn/${value}`));\r\n    book.olid && book.olid.forEach(value => imageLinks.push(`olid/${value}`));\r\n    book.oclc && book.oclc.forEach(value => imageLinks.push(`oclc/${value}`));\r\n    return imageLinks;\r\n  }\r\n\r\n  loadBookImage(imageLinks, i) {\r\n    if (!imageLinks[i] || imageLinks.length == this.i) return;\r\n    // console.log('link = ', imageLinks[i], '; i = ', i);\r\n    this.api.searchBookImage(imageLinks[i]).then(blob => {\r\n      let objectURL = window.URL.createObjectURL(blob);\r\n      let bookPicture = document.getElementById('bookPicture');\r\n      if (bookPicture.src === '') {\r\n        bookPicture.src = objectURL;\r\n      }\r\n    })\r\n    .catch (error => {\r\n      // console.log('error:', error);\r\n      // Если нету картинки по ссылке, смотрим следующую \r\n      // и так, пока не найдётся или не закончатся варианты\r\n      this.i++;\r\n      this.loadBookImage(this.imageLinks, this.i);\r\n    });\r\n  }\r\n//#region getFlagsHTML\r\n  getFlagHTML(item) {\r\n    // console.log(item);\r\n    if (item == 'eng') item = 'gb';\r\n    if (item == 'rus') item = 'ru';\r\n    if (item == 'spa') item = 'es';\r\n    if (item == 'esp') item = 'es';\r\n    if (item == 'ger') item = 'de';\r\n    if (item == 'chi') item = 'cn';\r\n    if (item == 'ukr') item = 'ua';\r\n    if (item == 'fre') item = 'fr';\r\n    if (item == 'ita') item = 'it';\r\n    if (item == 'jpn') item = 'jp';\r\n    if (item == 'por') item = 'pt';\r\n    if (item == 'iri') item = 'ie';\r\n    if (item == 'alb') item = 'al';\r\n    if (item == 'scc') item = 'rs';\r\n    if (item == 'dut') item = 'nl';\r\n    if (item == 'dan') item = 'dk';\r\n    if (item == 'cze') item = 'cz';\r\n    if (item == 'mon') item = 'mn';\r\n    if (item == 'scr') item = 'hr';\r\n    if (item == 'hrv') item = 'hr';\r\n    if (item == 'ara') item = 'ae';\r\n    if (item == 'pol') item = 'pl';\r\n    if (item == 'fin') item = 'fi';\r\n    if (item == 'swe') item = 'se';\r\n    if (item == 'rum') item = 'ro';\r\n    if (item == 'est') item = 'ee';\r\n    if (item == 'sco') item = 'gb-sct';\r\n    if (item == 'grc') item = 'gr';\r\n    if (item == 'hun') item = 'hu';\r\n    if (item == 'slo') item = 'sk';\r\n    if (item == 'kor') item = 'kr';\r\n    if (item == 'ice') item = 'is';\r\n    if (item == 'bul') item = 'bg';\r\n    if (item == 'tur') item = 'tr';\r\n    if (item == 'gre') item = 'gr';\r\n    if (item == 'arm') item = 'am';\r\n    if (item == 'wal') item = 'gb-wls';\r\n    if (item == 'amh') item = 'et';\r\n    if (item == 'mol') item = 'md';\r\n    if (item == 'tgl') item = 'ph';\r\n    if (item == 'heb') item = 'il';\r\n    if (item == 'lit') item = 'lt';\r\n    if (item == 'vie') item = 'vn';\r\n    if (item == 'nor') item = 'no';\r\n    if (item.length === 3) return ``;\r\n    return `<img class=\"book-info__flag\" src=\"https://flagcdn.com/16x12/${item}.png\"></img> `;\r\n  }\r\n  //#endregion getFlagsHTML\r\n}","'use strict';\r\n\r\nexport class ButtonsController {\r\n  bookId;\r\n  constructor(storage, bookInfo) {\r\n    // console.log('ButtonsController');\r\n    this.storage = storage;\r\n    this.bookInfo = bookInfo;\r\n    this.readList = document.getElementById(\"readList\");\r\n    const addToReadButton = document.getElementById(\"addToReadButton\");\r\n\r\n    addToReadButton.addEventListener(\"click\", e => \r\n    this.bookInfo.addToReadList(this.storage));\r\n\r\n    this.readList.addEventListener(\"click\", e => this.trackElement(e));\r\n  }\r\n\r\n  trackElement(e) {\r\n    let item = e.target;\r\n    if (item.tagName == 'BUTTON') {\r\n      // console.log('click button');\r\n      this.bookId = item.parentNode.parentNode.parentNode.parentNode.dataset.bookId;\r\n      this.onChangeReadList(this.bookId, item.id);\r\n    }  \r\n    if (item.tagName == 'DIV') {\r\n      // console.log('click book');\r\n      this.bookId = item.dataset.bookId;\r\n      this.showBook(this.bookId, e);\r\n    }\r\n  }\r\n\r\n  onChangeReadList(bookId, divId) {\r\n    const myBooks = this.storage.get(\"myBooks\");\r\n    myBooks.forEach((item, i, object) => {\r\n      if (item.id == bookId) {\r\n        if (divId == 'markAsReadButton') {\r\n          item.read = true;\r\n        }\r\n        if (divId == 'unmarkAsReadButton') {\r\n          item.read = false;\r\n        }\r\n        if (divId == 'removefromListButton') {\r\n          object.splice(i, 1);\r\n        }\r\n      }\r\n    });\r\n    this.storage.set(\"myBooks\", myBooks);\r\n  }\r\n\r\n  showBook(bookId, e) {\r\n    const targetDiv = e.target;\r\n    const myBooks = this.storage.get(\"myBooks\");\r\n    const selectBook = myBooks.find(item => item.id == bookId);\r\n    if (!selectBook) {\r\n      return;\r\n    }\r\n    const LastSelectedBook = document.getElementsByClassName(\"book-card--active\");\r\n    if (LastSelectedBook[0]) {\r\n      LastSelectedBook[0].classList.remove(\"book-card--active\");\r\n    }\r\n    this.LastSelectedBook = selectBook;\r\n    targetDiv.classList.add(\"book-card--active\");\r\n\r\n    this.bookInfo.setBookInfo(selectBook);\r\n  }\r\n}","'use strict';\r\n\r\nexport class BookCard {\r\n  constructor(bookInfo) {\r\n    // console.log('BookCard');\r\n    this.currentPage = [];\r\n    this.bookInfo = bookInfo;\r\n    const booksList = document.querySelector(\"#booksList\");\r\n    booksList.addEventListener(\"click\", e => \r\n    this.onClickBookCard(e, this.currentPage));\r\n  }\r\n\r\n  setCurrentPage(currentPage) {\r\n    this.currentPage = currentPage;\r\n  }\r\n\r\n  onClickBookCard(e, currentPage) {\r\n    const targetDiv = e.target;\r\n    const id = targetDiv.id;\r\n    const selectBook = currentPage.find(item => item.id === id);\r\n    if (!selectBook) {\r\n      return;\r\n    }\r\n\r\n    const LastSelectedBook = document.getElementsByClassName(\"book-card--active\");\r\n    if (LastSelectedBook[0]) {\r\n      LastSelectedBook[0].classList.remove(\"book-card--active\");\r\n    }\r\n    \r\n    this.LastSelectedBook = selectBook;\r\n    targetDiv.classList.add(\"book-card--active\");\r\n    this.bookInfo.setBookInfo(selectBook);\r\n  }\r\n}","'use strict';\r\nimport skin from './../img/skin.png';\r\n\r\n// import url from \"file!./file.png\"\r\n// import image from '/../src/img/skin.png';\r\nexport class BooksList {\r\n  constructor() {\r\n    // console.log('BooksList');\r\n    this.currentPage = [];\r\n    // const booksList =     document.querySelector(\"#booksList\");\r\n    // const booksShown =    document.querySelector(\"#booksShown\");\r\n    // const booksFound =    document.querySelector(\"#booksFound\");\r\n  }\r\n\r\n  addBooksList(page) {\r\n    page.docs.forEach(item => {\r\n      item.id = item.key.split(\"/\").pop();\r\n    });\r\n    this.currentPage = page.docs;\r\n    const blueBook = `https://www.clker.com/cliparts/c/f/n/A/k/T/book-th.png`;\r\n    const redBook = `https://www.clker.com/cliparts/U/a/w/s/n/V/c-users-public-pictures-sample-pictures-th.png`;\r\n\r\n    const booksListHTML = this.currentPage.reduce((acc, item) => {\r\n      return (acc +\r\n        `<div id=\"${item.id}\" class=\"book-card\">\r\n          <div class=\"book-card__container\">\r\n\r\n            <img class=\"book-card__img\" src=\"${item.cover_i \r\n            ? `https://covers.openlibrary.org/b/id/${item.cover_i}-L.jpg?default=false` \r\n              : `${item.isbn \r\n                ? `https://covers.openlibrary.org/b/isbn/${item.isbn[0]}-L.jpg?default=false`\r\n              : `${skin}`}`\r\n            }\" onError=\"this.src='${skin}'\">\r\n            <div class=\"book-card__header\">\r\n              <span class=\"book-card__title\">${item.title}</span> \r\n              ${item.language ? `<span class=\"book-card__lang\">${item.language.join(\", \")}</span>` : ``}\r\n              ${item.subtitle ? `<div class=\"book-card__subtitle\">${item.subtitle}</div>` : ``}\r\n            </div> \r\n          </div> \r\n        </div>`\r\n      );\r\n    }, \"\");\r\n\r\n    booksList.innerHTML += booksListHTML;\r\n    booksShown.innerHTML = `Shown books: ${this.numShown(page)}`;\r\n    booksFound.innerHTML = `Found books: ${page.numFound}`;\r\n  }\r\n  \r\n  numShown(page) {\r\n    const start = page.start;\r\n    const pageSize = page.docs.length;\r\n    let numberShownBooks;\r\n    if (pageSize == 100) {\r\n      numberShownBooks = start + 100;\r\n    } else {\r\n      numberShownBooks = start + pageSize;\r\n    }\r\n    return numberShownBooks;\r\n  }\r\n}\r\n","'use strict';\r\nimport { Api } from \"./api\";\r\nimport { BookCard } from \"./book-card\";\r\nimport { BooksList } from \"./books-list\";\r\n\r\nexport class Data {\r\n  api = new Api();\r\n  loadedPage = 0;\r\n  countPages = 0;\r\n  pageLoaded = false;\r\n  currentPage = [];\r\n  constructor(bookInfo) {\r\n    // console.log('Data');\r\n    this.bookList = new BooksList();\r\n    this.bookCard = new BookCard(bookInfo);\r\n    this.querry = '';\r\n  }\r\n\r\n  getData(querry, page) {\r\n    if (!querry) {\r\n      return;\r\n    }\r\n    this.pageLoaded = false;\r\n    this.querry = querry;\r\n    this.loadedPage = page;\r\n    if (page == 1)  {\r\n      booksList.innerHTML = ``;\r\n      this.currentPage.length = 0;\r\n      spinnerBig.style.display = \"block\";\r\n    } else if (page > 1) {\r\n      spinnerMini.style.display = 'block';\r\n    }\r\n    this.api.searchBooksQuerry(querry, page).then(page => {\r\n      this.currentPage = this.currentPage.concat(page.docs);\r\n      this.bookCard.setCurrentPage(this.currentPage);\r\n      this.bookList.addBooksList(page);\r\n      this.getCountPages(page);\r\n      this.pageLoaded = true;\r\n      spinnerBig.style.display = \"none\";\r\n      spinnerMini.style.display = 'none';\r\n      // console.log(this.currentPage);\r\n    });\r\n  }\r\n  \r\n  getCountPages(page) {\r\n    const start = page.start;\r\n    const numFound = page.numFound;\r\n    this.countPages = Math.ceil(numFound/100);\r\n    this.loadedPage = Math.ceil((start+100)/100);\r\n  }\r\n  \r\n  addData() {\r\n    if (this.loadedPage < this.countPages) {\r\n      this.pageLoaded = false;\r\n      this.getData(this.querry, this.loadedPage+1)\r\n      // console.log('новые данные ещё нужны');\r\n    }\r\n    if (this.loadedPage == this.countPages) {\r\n      // console.log('новые данные не нужны');\r\n    }\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport class MenuController {\r\n\r\n  constructor(data) {\r\n    // console.log('MenuController');\r\n    const onSearchListBtn =     document.querySelector(\"#onSearchListBtn\");\r\n    const onInfoListBtn =   document.querySelector(\"#onInfoListBtn\");\r\n    const onReadListBtn =   document.querySelector(\"#onReadListBtn\");\r\n    this.leftBlock =   document.querySelector(\"#leftBlock\");\r\n    this.centerBlock =   document.querySelector(\"#centerBlock\");\r\n    this.rightBlock =   document.querySelector(\"#rightBlock\");\r\n    \r\n    // window.addEventListener(`resize`, e => {\r\n    //   console.log(e.target.innerHeight);\r\n    //   console.log(e.target.innerWidth);\r\n    // }, false);\r\n\r\n    onInfoListBtn.addEventListener('click', e => {\r\n      console.log('onInfoListBtn');\r\n      this.leftBlock.style.zIndex = 0;\r\n      this.centerBlock.style.zIndex = 1;\r\n      this.rightBlock.style.zIndex = 0;\r\n    });\r\n\r\n    onReadListBtn.addEventListener('click', e => {\r\n      console.log('onReadListBtn');\r\n      this.leftBlock.style.zIndex = 0;\r\n      this.centerBlock.style.zIndex = 0;\r\n      this.rightBlock.style.zIndex = 1;\r\n    });\r\n\r\n    onSearchListBtn.addEventListener('click', e => {\r\n      console.log('onSearchListBtn');\r\n      this.leftBlock.style.zIndex = 1;\r\n      this.centerBlock.style.zIndex = 0;\r\n      this.rightBlock.style.zIndex = 0;\r\n    });\r\n  }\r\n}\r\n\r\n\r\n","'use strict';\r\n\r\nexport class ScrollController {\r\n  canAddData = true;\r\n  isLoadedNewData = false;\r\n  constructor(data) {\r\n    // console.log('ScrollController');\r\n    // console.log(data);\r\n    this.data = data;\r\n    const scrollBooksList = document.querySelector('#scrollBooksList');\r\n    const spinnerMini = document.querySelector('#spinnerMini');\r\n    scrollBooksList.addEventListener(\"scroll\", (e) => {\r\n      this.isScrolledIntoView(scrollBooksList);\r\n    });\r\n  }\r\n\r\n  isScrolledIntoView(scroll) {\r\n    let docViewTop = scroll.scrollTop; \r\n    let docViewBottom = docViewTop + scroll.offsetHeight;\r\n    let scrollHeigh = scroll.scrollHeight;\r\n    if (docViewBottom + 100 >= scrollHeigh) {\r\n      // scroll in target bottom\r\n      if (this.canAddData && this.data.pageLoaded) {\r\n        this.data.addData();\r\n      } \r\n    }\r\n  }\r\n}","'use strict';\r\n\r\nexport class SearchController {\r\n  constructor(data) {\r\n    // console.log('SearchController');\r\n    this.data = data;\r\n    // const booksList =     document.querySelector(\"#booksList\");\r\n    // const searchInput =   document.querySelector(\"#searchInput\");\r\n    // const searchClear =   document.querySelector(\"#searchClear\");\r\n    // const searchButton =  document.querySelector(\"#searchButton\");\r\n    const debounce = (callback, delay = 250) => {\r\n      let timeoutId\r\n      return (...args) => {\r\n        clearTimeout(timeoutId)\r\n        timeoutId = setTimeout(() => {\r\n          timeoutId = null\r\n          data.getData(searchInput.value, 1);\r\n          callback(...args)\r\n        }, delay)\r\n      }\r\n    }\r\n    const debouncedGreet = debounce(this.onChangeInput, 777);\r\n    searchInput.addEventListener(\"keyup\", (e) => debouncedGreet(e));\r\n    searchButton.addEventListener(\"click\", (e) => this.data.getData(searchInput.value, 1));\r\n    searchClear.addEventListener(\"click\", (e) => (this.onClickClear(e)));\r\n    searchInput.addEventListener(\"keyup\", (e) => {\r\n      let value = e.path[0].value;\r\n      searchClear.style.display = (value == \"\" || undefined) ? 'none' : 'block';\r\n      if(e.code === 'Enter') {\r\n        this.data.getData(searchInput.value, 1);\r\n      }\r\n      if(e.code === 'Backspace' && value == \"\") {\r\n        this.onClearBooksList();\r\n      }\r\n    });\r\n    searchInput.focus();\r\n  }\r\n\r\n  onChangeInput(e) {\r\n    // console.log(`after 777 ms. data(Value) = ${e.target.value}`);\r\n  }\r\n  \r\n  onClickClear(e) {\r\n    searchInput.value = \"\";\r\n    e.currentTarget.style.display = 'none';\r\n    this.onClearBooksList();\r\n  }\r\n\r\n  onClearBooksList() {\r\n    addToReadButton.style.display = 'none';\r\n    booksList.innerHTML = ``;\r\n    bookInfoHeader.innerHTML = ``;\r\n    bookInfoProps.innerHTML = ``;\r\n    booksShown.innerHTML = `Shown books: 0`;\r\n    booksFound.innerHTML = `Found books: 0`;\r\n  }\r\n}\r\n\r\n\r\n","'use strict';\r\nimport skin from './../img/skin.png';\r\n\r\nexport class ReadList {\r\n  books = [];\r\n  BookCount = 0;\r\n  ReadCount = 0;\r\n  constructor() {\r\n    // console.log('ReadList');\r\n    this.readListBookCount = document.getElementById(\"readListBookCount\");\r\n    this.readListReadCount = document.getElementById(\"readListReadCount\");\r\n    this.readListBook = document.getElementById(\"readListBook\");\r\n    this.readListRead = document.getElementById(\"readListRead\");\r\n\r\n  }\r\n\r\n  loadReadList(storage) {\r\n    const myBooks = storage.get(\"myBooks\");\r\n    if (myBooks) { \r\n      this.setReadListHTML(myBooks, false);   // не прочитанные книги\r\n      this.setReadListHTML(myBooks, true);    // прочитанные книги\r\n      this.setListAboutHTML(myBooks)\r\n    } \r\n    storage.show(\"myBooks\");\r\n  }\r\n\r\n  setReadListHTML(myBooks, bool) {\r\n    const blueBook = `https://www.clker.com/cliparts/c/f/n/A/k/T/book-th.png`;\r\n    const redBook = `https://www.clker.com/cliparts/U/a/w/s/n/V/c-users-public-pictures-sample-pictures-th.png`;\r\n    let targetDiv = bool ? this.readListRead : this.readListBook;\r\n\r\n    targetDiv.innerHTML = myBooks\r\n    .sort((prev, next) => {\r\n      if ( prev.title < next.title ) return -1;\r\n      if ( prev.title < next.title ) return 1;\r\n    })\r\n    .filter(item => item.read == bool)\r\n    .map(item => \r\n      `<div data-book-id=\"${item.id}\" class=\"book-card book-card--read-${bool}\">\r\n        <div class=\"book-card__container book-card__container\">\r\n          <img class=\"book-card__img\" src=\"${item.cover_i \r\n            ? `https://covers.openlibrary.org/b/id/${item.cover_i}-L.jpg?default=false` \r\n              : `${item.isbn \r\n                ? `https://covers.openlibrary.org/b/isbn/${item.isbn[0]}-L.jpg?default=false`\r\n              : `${skin}`}`\r\n            }\" onError=\"this.src='${skin}'\">\r\n            <div class=\"book-card__header\">\r\n            <span class=\"book-card__title\">${item.title}</span> \r\n            ${item.language ? `<span class=\"book-card__lang\">${item.language.join(\", \")}</span>` : ``}\r\n            ${item.subtitle && (!bool) ? `<div class=\"book-card__subtitle\">${item.subtitle}</div>` : ``}\r\n            ${item.author_name ? `<div class=\"book-card__author\">${item.author_name.join(\", \")}</div>` : ``}\r\n            <div class=\"book-card__buttons\">\r\n              <button class=\"book-card__button\" id=\"${bool ? `un` : ``}markAsReadButton\">${bool ? `un` : ``}Mark as read</button>\r\n              <button class=\"book-card__button\" id=\"removefromListButton\">Remove from list</button>\r\n            </div>\r\n            </div> \r\n        </div> \r\n      </div>`\r\n    ).join(\"\");\r\n  }\r\n\r\n  setListAboutHTML(myBooks) {\r\n    this.BookCount = myBooks.length;\r\n    this.readListBookCount.innerHTML = \r\n    `<div class=\"read-list__item\" id=\"readListBookCount\">${this.BookCount} books,</div>`;\r\n\r\n    this.ReadCount = myBooks.filter(item => item.read == true).length;\r\n    this.readListReadCount.innerHTML = \r\n    `<div class=\"read-list__item\" id=\"readListBookCount\">${this.ReadCount} read</div>`;\r\n  }\r\n}","'use strict';\r\n\r\nimport { ReadList } from \"./read-list\";\r\n\r\nexport class Storage {\r\n  constructor() {\r\n    // console.log('Storage');\r\n    // this.clear();\r\n    this.readList = new ReadList();\r\n    this.refresh();\r\n  }\r\n\r\n  refresh() {\r\n    this.readList.loadReadList(this);\r\n  }\r\n\r\n\r\n  get(name) {\r\n    // name = \"myBooks\", \"myTheme\"\r\n    return JSON.parse(localStorage.getItem(name))\r\n  }\r\n\r\n  set(name, value) { \r\n    // \"myBooks\" = [{},{},{}]\r\n    // \"myTheme\" = \"dark\"\r\n    localStorage.setItem(name, JSON.stringify(value)); \r\n    this.refresh();\r\n  }\r\n\r\n  clear() {\r\n    console.log('Clear storage');\r\n    localStorage.clear(); \r\n  }\r\n\r\n  show(name) {\r\n    // console.log(`${name} = `, this.get(name));\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport class ToggleTheme {\r\n  theme;\r\n  constructor(storage) {    \r\n    // console.log('ToggleTheme');\r\n    this.storage = storage;\r\n    toggleThemeButton.addEventListener('click', e => this.toggleTheme());\r\n    // localStorage.removeItem(\"myTheme\");\r\n    this.loadTheme();\r\n  }\r\n\r\n  loadTheme() {\r\n    const myTheme = this.storage.get(\"myTheme\");\r\n    if (myTheme == 'light' || myTheme == null) {\r\n      this.theme = 'light';\r\n      sunIcon.style.display = \"block\";\r\n      moonIcon.style.display = \"none\";\r\n    }\r\n    if (myTheme == 'dark') {\r\n      this.theme = 'dark';\r\n      sunIcon.style.display = \"none\";\r\n      moonIcon.style.display = \"block\";\r\n      document.documentElement.setAttribute('theme', 'dark');\r\n    }\r\n  }\r\n\r\n  toggleTheme() {\r\n    // console.log(this.toggleButton.children[0].src);\r\n    if (document.documentElement.hasAttribute('theme')) {\r\n      document.documentElement.removeAttribute('theme');\r\n      this.storage.set(\"myTheme\", \"light\");\r\n      sunIcon.style.display = \"block\";\r\n      moonIcon.style.display = \"none\";\r\n      // this.toggleButton.children[0].src = \"./src/img/sun.png\";\r\n    } else {\r\n      document.documentElement.setAttribute('theme', 'dark');\r\n      this.storage.set(\"myTheme\", \"dark\");\r\n      sunIcon.style.display = \"none\";\r\n      moonIcon.style.display = \"block\";\r\n      // this.toggleButton.children[0].src = \"./src/img/moon.png\";\r\n    }\r\n    this.storage.show(\"myTheme\");\r\n  }\r\n}","'use strict';\r\n\r\nimport { BookInfo } from \"./book-info\";\r\nimport { ButtonsController } from \"./buttons-controller\";\r\nimport { Data } from \"./data\";\r\nimport { MenuController } from \"./menu-controller\";\r\nimport { ScrollController } from \"./scroll-controller\";\r\nimport { SearchController } from \"./search-controller\";\r\nimport { Storage } from \"./storage\";\r\nimport { ToggleTheme } from \"./toggle-theme\";\r\n\r\nlet bookInfo = new BookInfo();\r\n\r\nlet data = new Data(bookInfo);\r\nnew SearchController(data);\r\nnew ScrollController(data);\r\n\r\nlet storage = new Storage();\r\nnew ToggleTheme(storage);\r\nnew ButtonsController(storage, bookInfo);\r\n\r\nnew MenuController();\r\n\r\n"]}